<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using Self-Organizing Maps with SOMbrero for dissimilarity matrices • SOMbrero</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using Self-Organizing Maps with SOMbrero for dissimilarity matrices">
<meta property="og:description" content="SOMbrero">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SOMbrero</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3-1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a-doc-SOMbrero-package.html">SOMbrero Package description</a>
    </li>
    <li>
      <a href="../articles/b-doc-grids.html">A basic vignette on grids in SOMbrero</a>
    </li>
    <li>
      <a href="../articles/c-doc-numericSOM.html">Using Self-Organizing Maps with SOMbrero to cluster a numeric dataset</a>
    </li>
    <li>
      <a href="../articles/d-doc-korrespSOM.html">Using Self-Organizing Maps with SOMbrero for contingency tables</a>
    </li>
    <li>
      <a href="../articles/e-doc-relationalSOM.html">Using Self-Organizing Maps with SOMbrero for dissimilarity matrices</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="http://github.com/tuxette/sombrero/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="e-doc-relationalSOM_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Using Self-Organizing Maps with SOMbrero for dissimilarity matrices</h1>
            
            <h4 class="date">10 août, 2020</h4>
      
      <small class="dont-index">Source: <a href="http://github.com/tuxette/sombrero/blob/master/vignettes/e-doc-relationalSOM.Rmd"><code>vignettes/e-doc-relationalSOM.Rmd</code></a></small>
      <div class="hidden name"><code>e-doc-relationalSOM.Rmd</code></div>

    </div>

    
    
<!--
%\VignetteEngine{knitr}
%\VignetteIndexEntry{SOM for dissimilarity data}
%\VignettePackage{SOMbrero}
-->
<p>To limit this documentation size, most figures are not displayed in the version of the vignette included in the package. To see all figures, you can rerun the vignettes, changing the following option to <code>TRUE</code>:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="kw pkg">knitr</span><span class="kw ns">::</span><span class="no"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html">opts_chunk</a></span>$<span class="fu">set</span>(<span class="kw">include</span> <span class="kw">=</span> <span class="fl">TRUE</span>)</pre></body></html></div>
<p>Alternatively, this compilation is also available at: <a href="http://sombrero.nathalievialaneix.eu/articles/e-doc-relationalSOM.html" class="uri">http://sombrero.nathalievialaneix.eu/articles/e-doc-relationalSOM.html</a></p>
<div id="basic-package-description" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-package-description" class="anchor"></a>Basic package description</h2>
<p><code>SOMbrero</code> implements different variants of the Self-Organizing Map algorithm (also called Kohonen’s algorithm). To process a given dataset with the SOM algorithm, you can use the function <code>trainSOM()</code>.</p>
<p><strong>This documentation only considers the case of dissimilarity matrices.</strong></p>
<div id="arguments" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments" class="anchor"></a>Arguments</h3>
<p>The <code>trainSOM</code> function has several arguments, but only the first one is required. This argument is <code>x.data</code> which is the dataset used to train the SOM. In this documentation, it is passed to the function as a square matrix or data frame, which entries are dissimilarity measures between pairs of observations. The diagonal of this matrix must contain only zeros.</p>
<p>The other arguments are the same as the arguments passed to the <code>initSOM</code> function (they are parameters defining the algorithm, see <code>help(initSOM)</code> for further details).</p>
</div>
<div id="outputs" class="section level3">
<h3 class="hasAnchor">
<a href="#outputs" class="anchor"></a>Outputs</h3>
<p>The <code>trainSOM</code> function returns an object of class <code>somRes</code> (see <code>help(trainSOM)</code> for further details on this class).</p>
</div>
<div id="graphics" class="section level3">
<h3 class="hasAnchor">
<a href="#graphics" class="anchor"></a>Graphics</h3>
<p>The following table indicates which graphics are available for a relational SOM.</p>
<table class="table">
<colgroup>
<col width="15%">
<col width="10%">
<col width="6%">
<col width="15%">
<col width="6%">
<col width="16%">
<col width="6%">
<col width="15%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th align="left">What <br><br> SOM or SC<br>Type</th>
<th align="left">SOM<br>Energy <br><br><br>
</th>
<th align="left">Obs <br><br><br><br>
</th>
<th align="left">Prototypes <br><br><br><br>
</th>
<th align="left">Add <br><br><br><br>
</th>
<th align="left">SuperCluster<br>(no what) <br><br><br>
</th>
<th align="left">Obs <br><br><br><br>
</th>
<th align="left">Prototypes <br><br><br><br>
</th>
<th align="left">Add <br><br><br><br>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(no type)</td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">hitmap</td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">color</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">lines</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left">x</td>
</tr>
<tr class="odd">
<td align="left">meanline</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
</tr>
<tr class="even">
<td align="left">barplot</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left">x</td>
</tr>
<tr class="odd">
<td align="left">pie</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
</tr>
<tr class="even">
<td align="left">boxplot</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
</tr>
<tr class="odd">
<td align="left">poly.dist</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">umatrix</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">smooth.dist</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">mds</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">grid.dist</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">words</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">names</td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">graph</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
</tr>
<tr class="odd">
<td align="left">projgraph</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
</tr>
<tr class="even">
<td align="left">grid</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">dendrogram</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">dendro3d</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="case-study-the-lesmis-data-set" class="section level2">
<h2 class="hasAnchor">
<a href="#case-study-the-lesmis-data-set" class="anchor"></a>Case study: the <code>lesmis</code> data set</h2>
<p>The <code>lesmis</code> data set is based on the coappearance graph of the characters of the novel Les Miserables (Victor Hugo). Each vertex stands for a character whose name is given by the vertex label. One edge means that the corresponding two characters appear in a common chapter in the book. Each edge also has a value indicating the number of coappearances. The co-appearance network has been extracted by D.E. Knuth (1993).</p>
<p>The <code>lesmis</code> data contain two objects: the first one,<code>lesmis</code>, is an <code>igraph</code> object (see <a href="http://igraph.sourceforge.net/">the igraph web page</a>), with 77 nodes and 254 edges.</p>
<p>Further information on this data set is provided with <code>help(lesmis)</code>.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="no">lesmis</span>)
<span class="no">lesmis</span></pre></body></html></div>
<pre><code>## IGRAPH 3babff7 U--- 77 254 -- 
## + attr: layout (g/n), id (v/n), label (v/c), value (e/n)
## + edges from 3babff7:
##  [1]  1-- 2  1-- 3  1-- 4  3-- 4  1-- 5  1-- 6  1-- 7  1-- 8  1-- 9  1--10
## [11] 11--12  4--12  3--12  1--12 12--13 12--14 12--15 12--16 17--18 17--19
## [21] 18--19 17--20 18--20 19--20 17--21 18--21 19--21 20--21 17--22 18--22
## [31] 19--22 20--22 21--22 17--23 18--23 19--23 20--23 21--23 22--23 17--24
## [41] 18--24 19--24 20--24 21--24 22--24 23--24 13--24 12--24 24--25 12--25
## [51] 25--26 24--26 12--26 25--27 12--27 17--27 26--27 12--28 24--28 26--28
## [61] 25--28 27--28 12--29 28--29 24--30 28--30 12--30 24--31 31--32 12--32
## [71] 24--32 28--32 12--33 12--34 28--34 12--35 30--35 12--36 35--36 30--36
## + ... omitted several edges</code></pre>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">lesmis</span>, <span class="kw">vertex.size</span> <span class="kw">=</span> <span class="fl">0</span>)</pre></body></html></div>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisDescr-1.png" width="1152"></p>
<p>The <code>dissim.lesmis</code> object is a matrix with entries equal to the length of the shortest path between two characters (obtained with the function <code>shortest.paths</code> of package <code>igraph</code>). Note that its row and column names have been initialized with the characters’ names to ease the use of the graphical functions of <code>SOMbrero</code>.</p>
<div id="training-the-som" class="section level3">
<h3 class="hasAnchor">
<a href="#training-the-som" class="anchor"></a>Training the SOM</h3>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">622</span>)
<span class="no">mis.som</span> <span class="kw">&lt;-</span> <span class="fu">trainSOM</span>(<span class="kw">x.data</span><span class="kw">=</span><span class="no">dissim.lesmis</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"relational"</span>, <span class="kw">nb.save</span> <span class="kw">=</span> <span class="fl">10</span>,
                   <span class="kw">init.proto</span> <span class="kw">=</span> <span class="st">"random"</span>, <span class="kw">radius.type</span> <span class="kw">=</span> <span class="st">"letremy"</span>)
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">mis.som</span>, <span class="kw">what</span><span class="kw">=</span><span class="st">"energy"</span>)</pre></body></html></div>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisTrain-1.png" width="700"></p>
<p>The dissimilarity matrix <code>dissim.lesmis</code> is passed to the <code>trainSOM</code> function as input. As the SOM intermediate backups have been registered (<code>nb.save = 10</code>), the energy evolution can be plotted: it stabilized in the last 100 iterations.</p>
</div>
<div id="resulting-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#resulting-clustering" class="anchor"></a>Resulting clustering</h3>
<p>The clustering component provides the classification of each of the 77 characters. The <code>table</code> function is a simple way to view data distribution on the map.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">mis.som</span>$<span class="no">clustering</span></pre></body></html></div>
<pre><code>##           Myriel         Napoleon   MlleBaptistine      MmeMagloire 
##               25               25               19               19 
##     CountessDeLo         Geborand     Champtercier         Cravatte 
##               25               25               25               25 
##            Count           OldMan          Labarre          Valjean 
##               25               25               22               22 
##       Marguerite           MmeDeR          Isabeau          Gervais 
##               16               22               23               23 
##        Tholomyes        Listolier          Fameuil      Blacheville 
##               11               11               11               11 
##        Favourite           Dahlia          Zephine          Fantine 
##               11               11               11               11 
##    MmeThenardier       Thenardier          Cosette           Javert 
##                2                6                7               17 
##     Fauchelevent       Bamatabois         Perpetue         Simplice 
##               18               21               11               17 
##      Scaufflaire           Woman1            Judge     Champmathieu 
##               22               22               21               21 
##           Brevet       Chenildieu      Cochepaille        Pontmercy 
##               21               21               21                9 
##     Boulatruelle          Eponine          Anzelma           Woman2 
##                6                1                2               17 
##   MotherInnocent          Gribier        Jondrette        MmeBurgon 
##               18               18               15               15 
##         Gavroche     Gillenormand           Magnon MlleGillenormand 
##               15                3                3               13 
##     MmePontmercy      MlleVaubois   LtGillenormand           Marius 
##                8               13                8                4 
##        BaronessT           Mabeuf         Enjolras       Combeferre 
##                3                5               10                5 
##        Prouvaire          Feuilly       Courfeyrac          Bahorel 
##               10                5                5               10 
##          Bossuet             Joly        Grantaire   MotherPlutarch 
##               10               10               10                5 
##        Gueulemer            Babet       Claquesous     Montparnasse 
##                1                1                1                1 
##        Toussaint           Child1           Child2           Brujon 
##               17               15               15                1 
##     MmeHucheloup 
##               10</code></pre>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">mis.som</span>$<span class="no">clustering</span>)</pre></body></html></div>
<pre><code>## 
##  1  2  3  4  5  6  7  8  9 10 11 13 15 16 17 18 19 21 22 23 25 
##  6  2  3  1  5  2  1  2  1  7  9  2  5  1  4  3  2  6  5  2  8</code></pre>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">mis.som</span>)</pre></body></html></div>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisClustering-1.png" width="700"></p>
<p>The clustering can be displayed using the <code>plot</code> function with <code>type = names</code>.</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">mis.som</span>, <span class="kw">what</span> <span class="kw">=</span> <span class="st">"obs"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"names"</span>)</pre></body></html></div>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisPseudoNamesPlot-1.png" width="1152"></p>
<p>In this clustering, the main character, Valjean, is in a central position (in cluster 8) and some clusters are easily identified as sub-stories around Javert. For instance, clusters 10, 15 and 20 are related to the Thénardier family, with (for instance), cluster 20 being the cluster of Gavroche and his two brothers (named children 1 and 2).</p>
<p>The original graph can also be superimposed on the map:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">mis.som</span>, <span class="kw">what</span> <span class="kw">=</span> <span class="st">"add"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"graph"</span>, <span class="kw">var</span> <span class="kw">=</span> <span class="no">lesmis</span>)</pre></body></html></div>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisProjGraph-1.png" width="700"></p>
<p>In the latter plot (which is still messy at this stage of the analysis), nodes correspond to clusters and are positionned at the cluster location on the map. The size of the nodes is proportional to the number of characters classified in this cluster and edges between nodes have a width proportional to the total weight between any two characters from the two linked clusters.</p>
<p>Clusters profile overviews can be plotted either with <em>e.g.</em>, lines or barplot, that both provide an information similar to that given by <code>"names"</code>.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">mis.som</span>, <span class="kw">what</span> <span class="kw">=</span> <span class="st">"prototypes"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"lines"</span>)  +
  <span class="fu">guides</span>(<span class="kw">color</span> <span class="kw">=</span> <span class="fu">guide_legend</span>(<span class="kw">keyheight</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">label.theme</span> <span class="kw">=</span> <span class="fu">element_text</span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">6</span>))) +
  <span class="fu">theme</span>(<span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="fu">element_blank</span>(), <span class="kw">axis.ticks.x</span> <span class="kw">=</span> <span class="fu">element_blank</span>())</pre></body></html></div>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisProtoProfiles-1.png" width="700"></p>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">mis.som</span>, <span class="kw">what</span> <span class="kw">=</span> <span class="st">"prototypes"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"barplot"</span>)  +
  <span class="fu">guides</span>(<span class="kw">fill</span> <span class="kw">=</span> <span class="fu">guide_legend</span>(<span class="kw">keyheight</span> <span class="kw">=</span> <span class="fl">0.5</span>, <span class="kw">ncol</span> <span class="kw">=</span> <span class="fl">2</span>, <span class="kw">label.theme</span> <span class="kw">=</span> <span class="fu">element_text</span>(<span class="kw">size</span> <span class="kw">=</span> <span class="fl">6</span>))) +
  <span class="fu">theme</span>(<span class="kw">axis.text.x</span> <span class="kw">=</span> <span class="fu">element_blank</span>(), <span class="kw">axis.ticks.x</span> <span class="kw">=</span> <span class="fu">element_blank</span>())</pre></body></html></div>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisProtoProfiles-2.png" width="700"></p>
<p>On these graphics, one variable is represented respectively with a point or a slice. It is therefore easy to see which variable affects which cluster.</p>
<p>To see how different the clusters are, some graphics show the distances between prototypes. These graphics have exactly the same interpretation as for the other data types processed by <code>SOMbrero</code>.</p>
<ul>
<li><p><code>"poly.dist"</code> represents the distances between neighboring prototypes with polygons plotted for each cell of the grid. The smaller the distance between a polygon’s vertex and a cell border, the closer the pair of prototypes. The colors encode the number of observations in the neuron;</p></li>
<li><p><code>"umatrix"</code> fills the neurons of the grid using colors that represent the average distance between the current prototype and its neighbors;</p></li>
<li><p><code>"smooth.dist"</code> plots the mean distance between the current prototype and its neighbors with a color gradation;</p></li>
<li><p><code>"mds"</code> plots the number of the neuron on a map according to a Multi-Dimensional Scaling (MDS) projection;</p></li>
<li><p><code>"grid.dist"</code> plots a point for each pair of prototypes, with the <span class="math inline">\(x\)</span> coordinates representing the distance between the prototypes in the input space, and <span class="math inline">\(y\)</span> coordinates representing the distance between the corresponding neurons on the grid.</p></li>
</ul>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">mis.som</span>, <span class="kw">what</span> <span class="kw">=</span> <span class="st">"prototypes"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"poly.dist"</span>)</pre></body></html></div>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisProtoDist-1.png" width="700"></p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">mis.som</span>, <span class="kw">what</span> <span class="kw">=</span> <span class="st">"prototypes"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"smooth.dist"</span>)</pre></body></html></div>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisProtoDistb-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">mis.som</span>, <span class="kw">what</span> <span class="kw">=</span> <span class="st">"prototypes"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"umatrix"</span>)</pre></body></html></div>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisProtoDistb-2.png" width="700"></p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">mis.som</span>, <span class="kw">what</span> <span class="kw">=</span> <span class="st">"prototypes"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"mds"</span>)</pre></body></html></div>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisProtoDistb-3.png" width="700"></p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">mis.som</span>, <span class="kw">what</span> <span class="kw">=</span> <span class="st">"prototypes"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"grid.dist"</span>)</pre></body></html></div>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisProtoDistb-4.png" width="700"></p>
<p>Here we can see that the prototypes located in the top left and top right corners of the map (<em>e.g.</em>, clusters 5 and clusters 19-20 and 24-25) are further from the other neurons than in average.</p>
<p>Finally, with a graphical overview of the clustering</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">lesmis</span>, <span class="kw">vertex.label.color</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">25</span>)[<span class="no">mis.som</span>$<span class="no">clustering</span>],
     <span class="kw">vertex.size</span> <span class="kw">=</span> <span class="fl">0</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"left"</span>, <span class="kw">legend</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">25</span>, <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">25</span>), <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">19</span>)</pre></body></html></div>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisColorOverview-1.png" width="1152"></p>
<p>We can see that (for instance) cluster 25 is very relevant to the story: as the characters of this cluster appear only in the sub-story of the Bishop <code>Myriel</code>, he is the only connection for all other characters of cluster 25. The same kind of conclusion holds for cluster 20 (with Gavroche), among others. Most of the other clusters have a small number of observations: it thus seems relevant to compute super clusters.</p>
</div>
<div id="compute-super-clusters" class="section level3">
<h3 class="hasAnchor">
<a href="#compute-super-clusters" class="anchor"></a>Compute super clusters</h3>
<p>As the number of clusters is rather large with the SOM algorithm, it is possible to perform a hierarchical clustering on top of SOM results. First, let us have an overview of the dendrogram:</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="fu">superClass</span>(<span class="no">mis.som</span>))</pre></body></html></div>
<pre><code>## Warning in plot.somSC(superClass(mis.som)): Impossible to plot the rectangles: no super clusters.</code></pre>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisSCOverview-1.png" width="700"></p>
<p>According to the proportion of variance explained by super clusters, 5 groups seem to be a good choice (4 groups would have been relevant also. The clustering with 5 groups creates a group with only one cluster in it).</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">sc.mis</span> <span class="kw">&lt;-</span> <span class="fu">superClass</span>(<span class="no">mis.som</span>, <span class="kw">k</span> <span class="kw">=</span> <span class="fl">5</span>)
<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(<span class="no">sc.mis</span>)</pre></body></html></div>
<pre><code>## 
##    SOM Super Classes
##      Initial number of clusters :  25 
##      Number of super clusters   :  5 
## 
## 
##   Frequency table
## 1 2 3 4 5 
## 3 6 6 6 4 
## 
##   Clustering
##  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 
##  1  1  2  3  3  1  2  2  3  3  2  2  2  3  3  4  4  4  5  5  4  4  4  5  5 
## 
## 
##   ANOVA
##          F                       :  9.13755 
##          Degrees of freedom      :  4 
##          p-value                 :  5.00329e-06 
##                  significativity :  ***</code></pre>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">sc.mis</span>$<span class="no">cluster</span>)</pre></body></html></div>
<pre><code>## 
## 1 2 3 4 5 
## 3 6 6 6 4</code></pre>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">sc.mis</span>)</pre></body></html></div>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisSC-1.png" width="700"></p>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">sc.mis</span>, <span class="kw">what</span> <span class="kw">=</span> <span class="st">"prototypes"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"grid"</span>)</pre></body></html></div>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisSC2-1.png" width="700"></p>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">sc.mis</span>, <span class="kw">what</span> <span class="kw">=</span> <span class="st">"prototypes"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"lines"</span>)</pre></body></html></div>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisSC2-2.png" width="700"></p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">sc.mis</span>, <span class="kw">what</span> <span class="kw">=</span> <span class="st">"prototypes"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"mds"</span>)</pre></body></html></div>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisSC2-3.png" width="700"></p>
<div class="sourceCode" id="cb31"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">sc.mis</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"dendro3d"</span>)</pre></body></html></div>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisSC2-4.png" width="700"></p>
<div class="sourceCode" id="cb32"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">lesmis</span>, <span class="kw">vertex.size</span> <span class="kw">=</span> <span class="fl">0</span>,
     <span class="kw">vertex.label.color</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">5</span>)[<span class="no">sc.mis</span>$<span class="no">cluster</span>[<span class="no">mis.som</span>$<span class="no">clustering</span>]])
<span class="fu"><a href="https://rdrr.io/r/graphics/legend.html">legend</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="st">"left"</span>, <span class="kw">legend</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"SC"</span>, <span class="fl">1</span>:<span class="fl">5</span>), <span class="kw">col</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="fl">5</span>), <span class="kw">pch</span> <span class="kw">=</span> <span class="fl">19</span>)</pre></body></html></div>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisSCColorOverview-1.png" width="1152"></p>
<ul>
<li><p>cluster 1 contains <code>Myriel</code> and the characters involved in his sub-story;</p></li>
<li><p>cluster 2 constains <code>Valjean</code> which has a central position in the graph visualization, and most of the important character of the novel (including Javert, Fantine and Cosette);</p></li>
<li><p>cluster 3 countains people almost only connected to <code>Fantine</code> who links them to the rest of the novel;</p></li>
<li><p>cluster 4 contains <code>Gavroche</code>, the abandonned child of the <code>Thenardier</code>, and the characters of his sub-story (including Mr Thénardier and Gavroche’s two brothers and his sister, <code>Eponine</code>);</p></li>
<li><p>cluster 5 is a bit harder to interpret, with secondary characters related to <code>Thenardier</code> and to the main characters of the novel.</p></li>
</ul>
<p>SOMbrero also contains functions to compute a projected graph based on the super-clusters and to display it:</p>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="fu">projectIGraph</span>(<span class="no">sc.mis</span>, <span class="no">lesmis</span>)</pre></body></html></div>
<pre><code>## IGRAPH 8a55d4e UNW- 5 7 -- 
## + attr: layout (g/n), name (v/c), size (v/n), weight (e/n)
## + edges from 8a55d4e (vertex names):
## [1] 1--2 1--3 1--4 2--3 2--4 3--4 4--5</code></pre>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mar</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="fl">0</span>,<span class="fl">4</span>))
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">sc.mis</span>, <span class="kw">what</span> <span class="kw">=</span> <span class="st">"add"</span>, <span class="kw">type</span> <span class="kw">=</span> <span class="st">"projgraph"</span>, <span class="kw">variable</span> <span class="kw">=</span> <span class="no">lesmis</span>, <span class="kw">s.radius</span> <span class="kw">=</span> <span class="fl">2</span>)</pre></body></html></div>
<p><img src="e-doc-relationalSOM_files/figure-html/lesmisSCProjGraph-1.png" width="700"></p>
<p>This representation provides a simplified and interpretable display of the graph where the super clusters are represented by nodes with sizes proportional to the number of characters classified in them. The nodes are positionned at the center of gravity of the map clusters included in each super cluster. They are linked to each other with edges with width proportional to the total number of links between two characters of the correspondind super clusters. Here, the central brown/green node is the one of Valjean and the other main characters (super cluster 2), which appears to be strongly related to super cluster 4 in blue, with Gavroche’s neighbors.</p>
</div>
<div id="session-information" class="section level3">
<h3 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session information</h3>
<p>This vignette has been computed with the following environment:</p>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()</pre></body></html></div>
<pre><code>## R version 4.0.2 (2020-06-22)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 20.04.1 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=fr_FR.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=fr_FR.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=fr_FR.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=fr_FR.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] SOMbrero_1.3-1 igraph_1.2.5   ggplot2_3.3.2 
## 
## loaded via a namespace (and not attached):
##  [1] Rcpp_1.0.5           plyr_1.8.6           RColorBrewer_1.1-2  
##  [4] compiler_4.0.2       pillar_1.4.6         tools_4.0.2         
##  [7] digest_0.6.25        lattice_0.20-41      lubridate_1.7.9     
## [10] checkmate_2.0.0      evaluate_0.14        memoise_1.1.0       
## [13] lifecycle_0.2.0      tibble_3.0.3         gtable_0.3.0        
## [16] pkgconfig_2.0.3      png_0.1-7            rlang_0.4.7         
## [19] rstudioapi_0.11      yaml_2.2.1           pkgdown_1.5.1       
## [22] xfun_0.16            interp_1.0-33        metR_0.7.0          
## [25] withr_2.2.0          stringr_1.4.0        knitr_1.29          
## [28] generics_0.0.2       desc_1.2.0           fs_1.5.0            
## [31] vctrs_0.3.2          scatterplot3d_0.3-41 rprojroot_1.3-2     
## [34] grid_4.0.2           data.table_1.13.0    glue_1.4.1          
## [37] R6_2.4.1             rmarkdown_2.3        sp_1.4-2            
## [40] farver_2.0.3         deldir_0.1-28        magrittr_1.5        
## [43] backports_1.1.8      scales_1.1.1         htmltools_0.5.0     
## [46] ellipsis_0.3.1       MASS_7.3-51.6        ggwordcloud_0.5.0   
## [49] assertthat_0.2.1     colorspace_1.4-1     labeling_0.3        
## [52] stringi_1.4.6        munsell_0.5.0        crayon_1.3.4</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nathalie Vialaneix, Elise Maigne, Jerome Mariette, Madalina Olteanu, Fabrice Rossi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
