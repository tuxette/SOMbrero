<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using Self-Organizing Maps with SOMbrero to cluster a numeric dataset • SOMbrero</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using Self-Organizing Maps with SOMbrero to cluster a numeric dataset">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SOMbrero</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/1-doc-SOMbrero-package.html">SOMbrero Package description</a>
    </li>
    <li>
      <a href="../articles/2-doc-grids.html">A basic vignette on grids in SOMbrero</a>
    </li>
    <li>
      <a href="../articles/3-doc-numericSOM.html">Using Self-Organizing Maps with SOMbrero to cluster a numeric dataset</a>
    </li>
    <li>
      <a href="../articles/4-doc-korrespSOM.html">Self-Organizing Map for contingency tables</a>
    </li>
    <li>
      <a href="../articles/5-doc-relationalSOM.html">Self-Organizing Map for dissimilarity matrices</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Using Self-Organizing Maps with SOMbrero to cluster a numeric dataset</h1>
            
      
      
      <div class="hidden name"><code>3-doc-numericSOM.Rmd</code></div>

    </div>

    
    
<!--
%\VignetteEngine{knitr}
%\VignetteIndexEntry{SOM for numeric data}
%\VignettePackage{SOMbrero}
-->
<div id="using-self-organizing-maps-with-sombrero-to-cluster-a-numeric-dataset" class="section level1">
<h1 class="hasAnchor">
<a href="#using-self-organizing-maps-with-sombrero-to-cluster-a-numeric-dataset" class="anchor"></a>Using Self-Organizing Maps with <code>SOMbrero</code> to cluster a numeric dataset</h1>
<div id="basic-package-description" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-package-description" class="anchor"></a>Basic package description</h2>
<p>To be able to run the SOM algorithm, you have to load the package called <code>SOMbrero</code>. The function used to run it is called <code><a href="../reference/trainSOM.html">trainSOM()</a></code> and is detailed below.</p>
<p><strong>This documentation only considers the case of numerical data.</strong></p>
<div id="arguments" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments" class="anchor"></a>Arguments</h3>
<p>The <code>trainSOM</code> function has several arguments, but only the first one is required. This argument is <code>x.data</code> which is the dataset used to train the SOM. In this documentation, it is passed to the function as a matrix or a data frame with numeric variables in columns and observations of these variables in rows.</p>
<p>The other arguments are the same as the arguments passed to the <code>initSOM</code> function (they are parameters defining the algorithm, see <code><a href="https://www.rdocumentation.org/packages/utils/topics/help">help(initSOM)</a></code> for further details).</p>
</div>
<div id="outputs" class="section level3">
<h3 class="hasAnchor">
<a href="#outputs" class="anchor"></a>Outputs</h3>
<p>The <code>trainSOM</code> function returns an object of class <code>somRes</code> (see <code><a href="https://www.rdocumentation.org/packages/utils/topics/help">help(trainSOM)</a></code> for further details on this class).</p>
</div>
<div id="graphics" class="section level3">
<h3 class="hasAnchor">
<a href="#graphics" class="anchor"></a>Graphics</h3>
<p>The following table indicates which graphics are available for a numeric SOM.</p>
<table class="table">
<thead><tr class="header">
<th>Type</th>
<th align="center">Energy</th>
<th align="center">Obs</th>
<th align="center">Prototypes</th>
<th align="center">Add</th>
<th align="center">Super Cluster</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>no type</td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>hitmap</td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
</tr>
<tr class="odd">
<td>color</td>
<td align="center"></td>
<td align="center">x</td>
<td align="center">x</td>
<td align="center">x</td>
<td align="center">x2</td>
</tr>
<tr class="even">
<td>lines</td>
<td align="center"></td>
<td align="center">x</td>
<td align="center">x</td>
<td align="center">x</td>
<td align="center">x2</td>
</tr>
<tr class="odd">
<td>barplot</td>
<td align="center"></td>
<td align="center">x</td>
<td align="center">x</td>
<td align="center">x</td>
<td align="center">x2</td>
</tr>
<tr class="even">
<td>radar</td>
<td align="center"></td>
<td align="center">x</td>
<td align="center">x</td>
<td align="center">x</td>
<td align="center">x2</td>
</tr>
<tr class="odd">
<td>pie</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center">x</td>
</tr>
<tr class="even">
<td>boxplot</td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center">x</td>
<td align="center">x2</td>
</tr>
<tr class="odd">
<td>3d</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>poly.dist</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center">x</td>
</tr>
<tr class="odd">
<td>umatrix</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>smooth.dist</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>words</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
</tr>
<tr class="even">
<td>names</td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>graph</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center">x</td>
</tr>
<tr class="even">
<td>mds</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center">x</td>
</tr>
<tr class="odd">
<td>grid.dist</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>grid</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
</tr>
<tr class="odd">
<td>dendrogram</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
</tr>
<tr class="even">
<td>dendro3d</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
</tr>
</tbody>
</table>
<p>The plots marked by “x2”, in the “Super Cluster” column, are available for both data set variables and additional variables.</p>
</div>
</div>
<div id="first-case-study-simulated-data-in-012" class="section level2">
<h2 class="hasAnchor">
<a href="#first-case-study-simulated-data-in-012" class="anchor"></a>First case study: simulated data in <span class="math inline">\([0,1]^2\)</span>
</h2>
<p>The first case study show the clustering of points randomly distributed in the square <span class="math inline">\([0,1]^2\)</span>. The data are generated by:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">4031719</span>)
the.data &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="st">"x1"</span>=<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span>(<span class="dv">500</span>), <span class="st">"x2"</span>=<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span>(<span class="dv">500</span>))
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(the.data, <span class="dt">pch=</span><span class="dv">19</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/dataGeneration-1.png" width="700"></p>
<div id="training-the-som" class="section level3">
<h3 class="hasAnchor">
<a href="#training-the-som" class="anchor"></a>Training the SOM</h3>
<p>The numeric SOM algorithm is used to cluster the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">593</span>)
<span class="co"># run the SOM algorithm with 10 intermediate backups and 2000 iterations</span>
my.som &lt;-<span class="st"> </span><span class="kw"><a href="../reference/trainSOM.html">trainSOM</a></span>(<span class="dt">x.data=</span>the.data, <span class="dt">dimension=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">5</span>,<span class="dv">5</span>), <span class="dt">nb.save=</span><span class="dv">10</span>, <span class="dt">maxit=</span><span class="dv">2000</span>, 
                   <span class="dt">scaling=</span><span class="st">"none"</span>, <span class="dt">radius.type=</span><span class="st">"letremy"</span>)</code></pre></div>
<p>The energy evolves as described in the following graphic:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.som, <span class="dt">what=</span><span class="st">"energy"</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/energy-1.png" width="700"></p>
<p>It is stabilized during the last 500 iterations.</p>
</div>
<div id="clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#clustering" class="anchor"></a>Clustering</h3>
<p>The resulting clustering distribution can be visualized by the hitmap:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.som, <span class="dt">what=</span><span class="st">"obs"</span>, <span class="dt">type=</span><span class="st">"hitmap"</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/hitmapObs-1.png" width="700"></p>
<p>The observations are almost uniformly distributed on the map.</p>
<p>The clustering component allows us to plot the initial data according to the final clustering.</p>
<p><img src="3-doc-numericSOM_files/figure-html/clusteredData-1.png" width="700"></p>
</div>
<div id="clustering-interpretation" class="section level3">
<h3 class="hasAnchor">
<a href="#clustering-interpretation" class="anchor"></a>Clustering interpretation</h3>
<p>The values of the prototypes can be represented with the plot function and help interpret the clusters:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>))
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"color"</span>, <span class="dt">var=</span><span class="dv">1</span>, <span class="dt">main=</span><span class="st">"prototypes - x1"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"color"</span>, <span class="dt">var=</span><span class="dv">2</span>, <span class="dt">main=</span><span class="st">"prototypes - x2"</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/colorProto-1.png" width="480"></p>
<p>Here, the interpretation is simple enough: high values of the first variables x1 are located at the right side of the map and small values at the left side of the map. Large values of x2 are located at the top of the map, whereas, small values are located at the bottom of the map.</p>
<p>We obtain the same results with a similar plot on the observation mean values:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>))
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.som, <span class="dt">what=</span><span class="st">"obs"</span>, <span class="dt">type=</span><span class="st">"color"</span>, <span class="dt">var=</span><span class="dv">1</span>, <span class="dt">main=</span><span class="st">"obs mean values - x1"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.som, <span class="dt">what=</span><span class="st">"obs"</span>, <span class="dt">type=</span><span class="st">"color"</span>, <span class="dt">var=</span><span class="dv">2</span>, <span class="dt">main=</span><span class="st">"obs mean values - x2"</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/colorObs-1.png" width="480"></p>
<p>The prototypes coordinates are also registered for each intermediate backup so they can be displayed on different graphics to see the evolution in the prototypes organization. <img src="3-doc-numericSOM_files/figure-html/protoEvoluation-1.png" width="1440"></p>
<p>At the begining of the algorithm, the prototypes are randomly distributed in [0,1]^2 and then, they organize as a regular rectangular grid in <span class="math inline">\([0,1]^2\)</span>.</p>
</div>
</div>
<div id="second-case-study-the-iris-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#second-case-study-the-iris-dataset" class="anchor"></a>Second case study: the iris dataset</h2>
<p>This second case study is performed on the famous (Fisher’s or Anderson’s) iris data set that gives the measurements in centimeters of the variables sepal length and width and petal length and width, respectively, for 50 flowers from each of 3 species of iris (setosa, versicolor, and virginica).</p>
<div id="training-the-som-1" class="section level3">
<h3 class="hasAnchor">
<a href="#training-the-som-1" class="anchor"></a>Training the SOM</h3>
<p>The first four variables of the data set (that are the numeric variables) are used to map each flower on the SOM grid.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">255</span>)
<span class="co"># run the SOM algorithm with verbose set to TRUE</span>
iris.som &lt;-<span class="st"> </span><span class="kw"><a href="../reference/trainSOM.html">trainSOM</a></span>(<span class="dt">x.data=</span>iris[,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">verbose=</span><span class="ot">TRUE</span>, <span class="dt">nb.save=</span><span class="dv">5</span>)</code></pre></div>
<pre><code>## Self-Organizing Map algorithm...
## 
##   Parameters of the SOM
## 
##     SOM mode                       :  online 
##     SOM type                       :  numeric 
##     Affectation type               :  standard 
##     Grid                           : 
##       Self-Organizing Map structure
## 
##         Features   :
##            topology     :  square 
##            x dimension  :  5 
##            y dimension  :  5 
##            distance type:  euclidean 
## 
##     Number of iterations           :  750 
##     Number of intermediate backups :  5 
##     Initializing prototypes method :  random 
##     Data pre-processing type       :  unitvar 
##     Neighbourhood type             :  gaussian 
## 
## 0 % done
## 10 % done
## 20 % done
## 30 % done
## 40 % done
## 50 % done
## 60 % done
## 70 % done
## 80 % done
## 90 % done
## 100 % done</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris.som</code></pre></div>
<pre><code>##       Self-Organizing Map object...
##          online learning, type: numeric 
##          5 x 5 grid with square topology
##          neighbourhood type: gaussian 
##          distance type: euclidean</code></pre>
<p>As the energy is registered during the intermediate backups, we can have a look at its evolution.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"energy"</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/energyIris-1.png" width="700"></p>
<p>Here the energy does not stabilize as in the case of <code>dist.type="letremy"</code> because the Gaussian annealing of the neighbourhood is continuous and not stepwise.</p>
</div>
<div id="resulting-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#resulting-clustering" class="anchor"></a>Resulting clustering</h3>
<p>The clustering component contains the final classification of the dataset. It is a vector with length equal to the number of rows of the input dataset.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iris.som<span class="op">$</span>clustering</code></pre></div>
<pre><code>##   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18 
##   5   5   5   5   5   5   5   5   5   5   5   5   5   5   5   5   5   5 
##  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36 
##   5   5   5   5   5   5   5  10   5   5   5   5   5   5   5   5   5   5 
##  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54 
##   5   5   5   5   5  15   5   5   5   5   5   5   5   5  11   6  11  25 
##  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72 
##  23  25   6  25  18  25  25  19  25  24  20   6  19  25  24  25  12  24 
##  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90 
##  24  24  18   6  23  11  24  25  25  25  25  24  19   7  11  24  19  25 
##  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108 
##  25  18  25  25  25  19  25  24  20  25  21  24  21  23  21  21  25  21 
## 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 
##  22  21  11  23  21  24  23  16  22  21  21  24  21  24  21  23  21  21 
## 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 
##  23  23  22  21  21  21  22  23  24  21  16  11  18  21  21  21  24  21 
## 145 146 147 148 149 150 
##  21  21  23  22  16  18</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/table">table</a></span>(iris.som<span class="op">$</span>clustering)</code></pre></div>
<pre><code>## 
##  5  6  7 10 11 12 15 16 18 19 20 21 22 23 24 25 
## 48  4  1  1  6  1  1  3  5  5  2 23  5 10 15 20</code></pre>
<p>which can also be visualized by a hitmap plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"obs"</span>, <span class="dt">type=</span><span class="st">"hitmap"</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisHitmap-1.png" width="700"></p>
<p>To access the relevance of each explanatory variable in the definition of the clusters, the function <code>summary</code> includes an ANOVA with the factor being the clustering, for each (numeric) input variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(iris.som)</code></pre></div>
<pre><code>## 
## Summary
## 
##       Class :  somRes 
## 
##       Self-Organizing Map object...
##          online learning, type: numeric 
##          5 x 5 grid with square topology
##          neighbourhood type: gaussian 
##          distance type: euclidean 
## 
##       Final energy     : 0.8971201 
##       Topographic error: 0 
## 
##       ANOVA                : 
## 
##         Degrees of freedom :  15 
## 
##                    F pvalue significativity
## Sepal.Length  53.911      0             ***
## Sepal.Width   17.020      0             ***
## Petal.Length 306.406      0             ***
## Petal.Width  147.682      0             ***</code></pre>
<p>Here, all variables have significantly different means among the different clusters and can thus be considered to be relevant for the clustering definition.</p>
<p>Another useful function is <code>predict.somRes</code>. This function predicts the neuron to which a new observation would be assigned. The first argument must be a <code>somRes</code> object and the second one the new observation. Let us have a try on the first observation of the iris data set:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># call predict.somRes</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(iris.som, iris[<span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</code></pre></div>
<pre><code>## 5 
## 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># check the result of the final clustering with the SOM algorithm</span>
iris.som<span class="op">$</span>clustering[<span class="dv">1</span>]</code></pre></div>
<pre><code>## 1 
## 5</code></pre>
</div>
<div id="clustering-interpretation-1" class="section level3">
<h3 class="hasAnchor">
<a href="#clustering-interpretation-1" class="anchor"></a>Clustering interpretation</h3>
<div id="graphics-common-to-observations-and-prototypes" class="section level4">
<h4 class="hasAnchor">
<a href="#graphics-common-to-observations-and-prototypes" class="anchor"></a>Graphics common to observations and prototypes</h4>
<p><strong>NB: in all the following graphics, data are scaled in the preprocessing stage.</strong></p>
<p>Some graphics are shared between observations and prototypes. They allow you to plot the level values, either of the prototypes or of the observation means. In this example these common graphics are plotted for the mean observation values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">2</span>))
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"obs"</span>, <span class="dt">type=</span><span class="st">"color"</span>, <span class="dt">variable=</span><span class="dv">1</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>, 
     <span class="dt">main=</span><span class="st">"Sepal length"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"obs"</span>, <span class="dt">type=</span><span class="st">"color"</span>, <span class="dt">variable=</span><span class="dv">2</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>, 
     <span class="dt">main=</span><span class="st">"Sepal width"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"obs"</span>, <span class="dt">type=</span><span class="st">"color"</span>, <span class="dt">variable=</span><span class="dv">3</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>, 
     <span class="dt">main=</span><span class="st">"Petal length"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"obs"</span>, <span class="dt">type=</span><span class="st">"color"</span>, <span class="dt">variable=</span><span class="dv">4</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>, 
     <span class="dt">main=</span><span class="st">"Petal width"</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisGraphOP-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"lines"</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisGraphOP-2.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"obs"</span>, <span class="dt">type=</span><span class="st">"barplot"</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisGraphOP-3.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"obs"</span>, <span class="dt">type=</span><span class="st">"radar"</span>, <span class="dt">key.loc=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="dv">5</span>), <span class="dt">mar=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">0</span>))</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisGraphOP-4.png" width="700"></p>
<p>Empty squares catch the attention: none of the observations are assigned to clusters 4, 9, 14 and 19.</p>
<p>Let us analyse the results for cluster 5 more precisely. On the <code>"color"</code> plots, cluster 5 has the following results: high values for <code>Sepal.Width</code> and low values for all the other variables. These results are also noticeable in the other plots:</p>
<ul>
<li>on the <code>"lines"</code> plot, the second point shows a peak;</li>
<li>on the <code>"barplot"</code> plot, this evolution is observed again;</li>
<li>on the <code>"radar"</code> plot, the slice corresponding to <code>Sepal.Width</code> is very big whereas the two Petal slices are almost invisible.</li>
</ul>
<p>Flowers with a long sepal and all the other variables being small are classified in the top left corner of the map. Flowers with large sepals and petals (length and width) are classified in the bottom right corner of the map whereas flowers with small sepal length are classified in the top right corner of the map.</p>
</div>
<div id="more-graphics-on-observations" class="section level4">
<h4 class="hasAnchor">
<a href="#more-graphics-on-observations" class="anchor"></a>More graphics on observations</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"obs"</span>, <span class="dt">type=</span><span class="st">"boxplot"</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisObs-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">rownames</a></span>(iris)</code></pre></div>
<pre><code>##   [1] "1"   "2"   "3"   "4"   "5"   "6"   "7"   "8"   "9"   "10"  "11" 
##  [12] "12"  "13"  "14"  "15"  "16"  "17"  "18"  "19"  "20"  "21"  "22" 
##  [23] "23"  "24"  "25"  "26"  "27"  "28"  "29"  "30"  "31"  "32"  "33" 
##  [34] "34"  "35"  "36"  "37"  "38"  "39"  "40"  "41"  "42"  "43"  "44" 
##  [45] "45"  "46"  "47"  "48"  "49"  "50"  "51"  "52"  "53"  "54"  "55" 
##  [56] "56"  "57"  "58"  "59"  "60"  "61"  "62"  "63"  "64"  "65"  "66" 
##  [67] "67"  "68"  "69"  "70"  "71"  "72"  "73"  "74"  "75"  "76"  "77" 
##  [78] "78"  "79"  "80"  "81"  "82"  "83"  "84"  "85"  "86"  "87"  "88" 
##  [89] "89"  "90"  "91"  "92"  "93"  "94"  "95"  "96"  "97"  "98"  "99" 
## [100] "100" "101" "102" "103" "104" "105" "106" "107" "108" "109" "110"
## [111] "111" "112" "113" "114" "115" "116" "117" "118" "119" "120" "121"
## [122] "122" "123" "124" "125" "126" "127" "128" "129" "130" "131" "132"
## [133] "133" "134" "135" "136" "137" "138" "139" "140" "141" "142" "143"
## [144] "144" "145" "146" "147" "148" "149" "150"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"obs"</span>, <span class="dt">type=</span><span class="st">"names"</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>, <span class="dt">scale=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.9</span>,<span class="fl">0.5</span>))</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisObs-2.png" width="700"></p>
<ul>
<li>By default, the <code>"boxplot"</code> plot considers all numerical variables of the data set. As this example used the four numerical variables of the iris data set, four boxplots are plotted in each neuron.</li>
<li>The <code>"names"</code> plot prints, for each neuron, the names of the observations which are assigned to its cluster. Here, the row names of iris data set are simply the row numbers.</li>
</ul>
</div>
<div id="more-graphics-on-prototypes" class="section level4">
<h4 class="hasAnchor">
<a href="#more-graphics-on-prototypes" class="anchor"></a>More graphics on prototypes</h4>
<p>Some more graphics handling prototypes have been implemented.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">2</span>,<span class="dv">2</span>))
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"3d"</span>, <span class="dt">variable=</span><span class="dv">1</span>, <span class="dt">main=</span><span class="st">"Sepal length"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"3d"</span>, <span class="dt">variable=</span><span class="dv">2</span>, <span class="dt">main=</span><span class="st">"Sepal width"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"3d"</span>, <span class="dt">variable=</span><span class="dv">3</span>, <span class="dt">main=</span><span class="st">"Petal length"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"3d"</span>, <span class="dt">variable=</span><span class="dv">4</span>, <span class="dt">main=</span><span class="st">"Petal width"</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisProto-1.png" width="700"></p>
<p><code>"3d"</code> provides the same results as “color” but in a 3 dimensional graphic: x is the x dimension of the grid, y is the y dimension of the grid and z is the value of the prototype for the variable <code>variable</code> (by name or number in the dataset) of the corresponding neuron.</p>
<p>Also, some graphics are provided to visualize the distance between prototypes on the grid:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"poly.dist"</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisDistProto-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"umatrix"</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisDistProto-2.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"smooth.dist"</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisDistProto-3.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"mds"</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisDistProto-4.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"grid.dist"</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisDistProto-5.png" width="700"></p>
<ul>
<li><p><code>"poly.dist"</code> represents the distances between neighboring prototypes with polygons plotted for each cell of the grid. The smaller the distance between a polygon’s vertex and a cell border, the closer the pair of prototypes. The colors indicates the number of observations in the neuron (white is used for empty neurons);</p></li>
<li><p><code>"umatrix"</code> fills the neurons of the grid using colors that represent the average distance between the current prototype and its neighbors;</p></li>
<li><p><code>"smooth.dist"</code> plots the mean distance between the current prototype and its neighbors with a color gradation;</p></li>
<li><p><code>mds</code> plots the number of the neuron on a map according to a Multi Dimensional Scaling (MDS) projection;</p></li>
<li><p><code>grid.dist</code> plots a point for each pair of prototypes, with x coordinates representing the distance between the prototypes in the input space, and y coordinates representing the distance between the corresponding neurons on the grid.</p></li>
</ul>
<p>These graphics show that there is a big gap (large distances) in the diagonal that goes from the bottom left part of the map to its top right corner. Hence, for instance, the flowers classified in cluster 15 are rather different from those classified in cluster 20, even if these two clusters are adjacent on the map. This is also emphasized on the MDS plot where clusters 15 and 20 are not very close.</p>
</div>
<div id="graphics-showing-an-additional-variable" class="section level4">
<h4 class="hasAnchor">
<a href="#graphics-showing-an-additional-variable" class="anchor"></a>Graphics showing an additional variable</h4>
<div id="additional-factor" class="section level5">
<h5 class="hasAnchor">
<a href="#additional-factor" class="anchor"></a>additional factor</h5>
<p>Let us plot pies for all neurons according to the flower species of the observations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/class">class</a></span>(iris<span class="op">$</span>Species)</code></pre></div>
<pre><code>## [1] "factor"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/levels">levels</a></span>(iris<span class="op">$</span>Species)</code></pre></div>
<pre><code>## [1] "setosa"     "versicolor" "virginica"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"add"</span>, <span class="dt">type=</span><span class="st">"pie"</span>, <span class="dt">variable=</span>iris<span class="op">$</span>Species)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisAdd1-1.png" width="700"></p>
<p>This figure shows that the clustering produced by the SOM is indeed relevant to identify the three different species of iris: they are well separated on the map and almost all clusters only contain one species of iris.</p>
</div>
<div id="additional-numerical-vector" class="section level5">
<h5 class="hasAnchor">
<a href="#additional-numerical-vector" class="anchor"></a>additional numerical vector</h5>
<p>The <code>"color"</code> plot available for <code>"add"</code> is similar to the <code>"obs"</code> or <code>"prototypes"</code> cases. Here we choose as an additional variable the first variable of the iris data set, so we obtain the same graphic as above (see section <strong>Graphics common to observations and prototypes</strong>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"add"</span>, <span class="dt">type=</span><span class="st">"color"</span>, <span class="dt">variable=</span>iris<span class="op">$</span>Sepal.Length)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisAdd2-1.png" width="700"></p>
</div>
<div id="additional-numerical-matrix-or-data-frame" class="section level5">
<h5 class="hasAnchor">
<a href="#additional-numerical-matrix-or-data-frame" class="anchor"></a>additional numerical matrix or data frame</h5>
<p>The <code>"lines"</code>, <code>"barplot"</code>, <code>"radar"</code> and <code>"boxplot"</code> plots available for <code>"add"</code> are similar to the <code>"obs"</code> or <code>"prototypes"</code> cases.</p>
<p><code>"words"</code> is only implemented for an additional variable. In this case, the additional variable must be a contingency matrix: the words used on the graph are the names of the colums and the presence or lack of the word is expressed by respectively 1 or 0. The size of the words on the grid depends on the rate of presence in the observations of the current neuron.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># my.cont.mat is the contingency matrix corresponding to the variable </span>
<span class="co"># iris$Species - overview of the 5 first lines:</span>
my.cont.mat[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,]</code></pre></div>
<pre><code>##      setosa versicolor virginica
## [1,]      1          0         0
## [2,]      1          0         0
## [3,]      1          0         0
## [4,]      1          0         0
## [5,]      1          0         0</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"add"</span>, <span class="dt">type=</span><span class="st">"words"</span>, <span class="dt">variable=</span>my.cont.mat)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisAdd4-1.png" width="700"></p>
</div>
<div id="additional-non-numerical-vector" class="section level5">
<h5 class="hasAnchor">
<a href="#additional-non-numerical-vector" class="anchor"></a>additional non-numerical vector</h5>
<p><code>"names"</code> is similar to the <code>"names"</code> case implemented for <code>"obs"</code>. Here we choose to give the argument <code>variable</code> the row names of the iris data set: so we obtain the same graphic as above (see <strong>More graphics on observations</strong>).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"add"</span>, <span class="dt">type=</span><span class="st">"names"</span>, <span class="dt">variable=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">rownames</a></span>(iris),
     <span class="dt">scale=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.9</span>,<span class="fl">0.5</span>))</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisAdd5-1.png" width="700"></p>
<p>Then, we can try to call this plot again but on the variable <code>iris$Species</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"add"</span>, <span class="dt">type=</span><span class="st">"names"</span>, <span class="dt">variable=</span>iris<span class="op">$</span>Species)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisAdd5bis-1.png" width="700"></p>
<p>We obtain exactly the same plot as we obtained above for <code>"words"</code> with the contingency matrix corresponding to the variable <code>iris$Species</code>.</p>
</div>
</div>
</div>
<div id="analyze-the-projection-quality" class="section level3">
<h3 class="hasAnchor">
<a href="#analyze-the-projection-quality" class="anchor"></a>Analyze the projection quality</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/quality.html">quality</a></span>(iris.som)</code></pre></div>
<pre><code>## $topographic
## [1] 0
## 
## $quantization
## [1] 0.8798424</code></pre>
<p>By default, the quality function calculates both quantization and topographic errors. It is also possible to specify which one you want using the argument <code>quality.type</code>.</p>
<p>The topographic error value varies between 0 (good projection quality) and 1 (poor projection quality). Here, the topographic quality of the mapping is equal to 0.05 which means that all observations have a second best unit which is in the neighborhood of the best matching unit.</p>
<p>The quantization error is an unbounded positive number. The closer it is from 0, the better the projection quality.</p>
</div>
<div id="building-super-classes-from-the-resulting-som" class="section level3">
<h3 class="hasAnchor">
<a href="#building-super-classes-from-the-resulting-som" class="anchor"></a>Building super classes from the resulting SOM</h3>
<p>In the SOM algorithm, the number of clusters is necessarily close to the number of neurons on the grid (not necessarily equal as some neurons may have no observations assigned to them). This - quite large - number may not suit the original data for a clustering purpose.</p>
<p>A usual way to address clustering with SOM is to perform a hierarchical clustering on the prototypes. This clustering is directly available in the package <code>SOMbrero</code> using the function <code>superClass</code>. To do so, you can first have a quick overview to decide on the number of super clusters which suits your data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="../reference/superClass.html">superClass</a></span>(iris.som))</code></pre></div>
<pre><code>## Warning in plot.somSC(superClass(iris.som)): Impossible to plot the rectangles: no super clusters.</code></pre>
<p><img src="3-doc-numericSOM_files/figure-html/irisSC-1.png" width="700"></p>
<p>By default, the function plots both a dendrogram and the evolution of the percentage of explained variance. Here, 3 super clusters seem to be the best choice. The output of <code>superClass</code> is a <code>somSC</code> class object. Basic functions have been defined for this class:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.sc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/superClass.html">superClass</a></span>(iris.som, <span class="dt">k=</span><span class="dv">3</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(my.sc)</code></pre></div>
<pre><code>## 
##    SOM Super Classes
##      Initial number of clusters :  25 
##      Number of super clusters   :  3 
## 
## 
##   Frequency table
##  1  2  3 
## 10  6  9 
## 
##   Clustering
##  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 
##  1  1  2  2  2  3  1  1  2  2  3  3  1  1  2  3  3  3  1  1  3  3  3  1  1 
## 
## 
##   ANOVA
## 
##         Degrees of freedom :  2 
## 
##                    F pvalue significativity
## Sepal.Length 218.047      0             ***
## Sepal.Width   72.551      0             ***
## Petal.Length 836.146      0             ***
## Petal.Width  542.343      0             ***</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">plot.var=</span><span class="ot">FALSE</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisSC3-1.png" width="700"></p>
<p>Like <code>plot.somRes</code>, the function <code>plot.somSC</code> has an argument <code>type</code> which offers many different plots and can thus be combined with most of the graphics produced by <code>plot.somSC</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"grid"</span>, <span class="dt">plot.legend=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisSCplot-1.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"dendro3d"</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisSCplot3d-1.png" width="700"></p>
<p>Case <code>"grid"</code> fills the grid with colors according to the super clustering (and can provide a legend). Case <code>"dendro3d"</code> plots a 3d dendrogram.</p>
<p>A couple of plots from <code>plot.somRes</code> are also available for the super clustering. Some identify the super clusters with colors:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"hitmap"</span>, <span class="dt">plot.legend=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisSCplot2-1.png" width="576"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"lines"</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisSCplot2B-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"barplot"</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisSCplot2B-2.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"boxplot"</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisSCplot2B-3.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"mds"</span>, <span class="dt">plot.legend=</span><span class="ot">TRUE</span>, <span class="dt">cex =</span><span class="dv">2</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisSCplot2C-1.png" width="576"></p>
<p>And some others identify the super clusters with titles:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"color"</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisSCplot3-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"poly.dist"</span>)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisSCplot3-2.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"pie"</span>, <span class="dt">variable=</span>iris<span class="op">$</span>Species)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisSCplot3-3.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"radar"</span>, <span class="dt">key.loc=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="op">-</span><span class="fl">0.5</span>,<span class="dv">5</span>), <span class="dt">mar=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">2</span>,<span class="dv">0</span>))</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisSCplot3-4.png" width="700"></p>
<p>It is also possible to consider an additional variable using the argument <code>add.variable</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"color"</span>, <span class="dt">add.type=</span><span class="ot">TRUE</span>, <span class="dt">variable=</span>iris<span class="op">$</span>Sepal.Length)</code></pre></div>
<p><img src="3-doc-numericSOM_files/figure-html/irisSCplot4-1.png" width="700"></p>
<p>All these graphics help to see that super-cluster number 2 is found in the top right corner of the map and contains only flowers of the “setosa” species. Super cluster number 3, at the bottom right corner of the map, contains mostly flowers of the “virginica” species. The last super-cluster is located at the top right corner of the map and mostly contains flowers of the species “versicolor”.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#using-self-organizing-maps-with-sombrero-to-cluster-a-numeric-dataset">Using Self-Organizing Maps with <code>SOMbrero</code> to cluster a numeric dataset</a><ul class="nav nav-pills nav-stacked">
<li><a href="#basic-package-description">Basic package description</a></li>
      <li><a href="#first-case-study-simulated-data-in-012">First case study: simulated data in <span class="math inline">\([0,1]^2\)</span></a></li>
      <li><a href="#second-case-study-the-iris-dataset">Second case study: the iris dataset</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nathalie Vialaneix, Jerome Mariette, Madalina Olteanu, Fabrice Rossi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
