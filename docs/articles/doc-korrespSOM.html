<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Self-Organizing Map for contingency tables • SOMbrero</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Self-Organizing Map for contingency tables">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SOMbrero</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/doc-SOMbrero-package.html">SOMbrero Package description</a>
    </li>
    <li>
      <a href="../articles/doc-grids.html">A basic vignette on grids in SOMbrero</a>
    </li>
    <li>
      <a href="../articles/doc-korrespSOM.html">Self-Organizing Map for contingency tables</a>
    </li>
    <li>
      <a href="../articles/doc-numericSOM.html">Using Self-Organizing Maps with ```SOMbrero``` to cluster a numeric dataset</a>
    </li>
    <li>
      <a href="../articles/doc-relationalSOM.html">Self-Organizing Map for dissimilarity matrices</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Self-Organizing Map for contingency tables</h1>
            
      
      
      <div class="hidden name"><code>doc-korrespSOM.Rmd</code></div>

    </div>

    
    
<!--
%\VignetteEngine{knitr}
%\VignetteIndexEntry{SOM for contingency tables}
%\VignettePackage{SOMbrero}
-->
<div id="self-organizing-map-for-contingency-tables" class="section level1">
<h1 class="hasAnchor">
<a href="#self-organizing-map-for-contingency-tables" class="anchor"></a>Self-Organizing Map for contingency tables</h1>
<div id="basic-package-description" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-package-description" class="anchor"></a>Basic package description</h2>
<p>To be able to run the SOM algorithm, you have to load the package called <code>SOMbrero</code>. The function used to run it is called <code><a href="../reference/trainSOM.html">trainSOM()</a></code> and is detailed below.</p>
<p><strong>This documentation only considers the case of contingency tables.</strong></p>
<div id="arguments" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments" class="anchor"></a>Arguments</h3>
<p>The <code>trainSOM</code> function has several arguments, but only the first one is required. This argument is <code>x.data</code> which is the dataset used to train the SOM. In this documentation, it is passed to the function as a matrix or a data frame. This set must be a contingency table, i.e., it must contain either 0 or positive integers. Column and row names must be supplied.</p>
<p>The other arguments are the same as the arguments passed to the <code>initSOM</code> function (they are parameters defining the algorithm, see <code><a href="https://www.rdocumentation.org/packages/utils/topics/help">help(initSOM)</a></code> for further details).</p>
</div>
<div id="outputs" class="section level3">
<h3 class="hasAnchor">
<a href="#outputs" class="anchor"></a>Outputs</h3>
<p>The <code>trainSOM</code> function returns an object of class <code>somRes</code> (see <code><a href="https://www.rdocumentation.org/packages/utils/topics/help">help(trainSOM)</a></code> for further details on this class).</p>
</div>
</div>
<div id="case-study-the-presidentielles2002-data-set" class="section level2">
<h2 class="hasAnchor">
<a href="#case-study-the-presidentielles2002-data-set" class="anchor"></a>Case study: the <code>presidentielles2002</code> data set</h2>
<p>The <code>presidentielles2002</code> data set provides the number of votes at the first round of the 2002 French presidential election for each of the 16 candidates in all of the 106 French administrative districts called “departements”. Further details about this data set and the 2002 French presidential election are given with <code><a href="https://www.rdocumentation.org/packages/utils/topics/help">help(presidentielles2002)</a></code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(presidentielles2002)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/apply">apply</a></span>(presidentielles2002, <span class="dv">2</span>, sum)</code></pre></div>
<pre><code>##      MEGRET      LEPAGE  GLUCKSTEIN      BAYROU      CHIRAC      LE_PEN 
##      667043      535875      132696     1949219     5666021     4804772 
##     TAUBIRA SAINT_JOSSE      MAMERE      JOSPIN      BOUTIN         HUE 
##      660515     1204801     1495774     4610267      339157      960548 
## CHEVENEMENT     MADELIN   LAGUILLER  BESANCENOT 
##     1518568     1113551     1630118     1210562</code></pre>
<p>(the two candidates that ran the second round of the election were Jacques Chirac and the far-right candidate Jean-Marie Le Pen)</p>
<div id="training-the-som" class="section level3">
<h3 class="hasAnchor">
<a href="#training-the-som" class="anchor"></a>Training the SOM</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">01091407</span>)
korresp.som &lt;-<span class="st"> </span><span class="kw"><a href="../reference/trainSOM.html">trainSOM</a></span>(<span class="dt">x.data=</span>presidentielles2002, <span class="dt">dimension=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">8</span>,<span class="dv">8</span>),
                        <span class="dt">type=</span><span class="st">"korresp"</span>, <span class="dt">scaling=</span><span class="st">"chi2"</span>, <span class="dt">nb.save=</span><span class="dv">10</span>,
                        <span class="dt">radius.type=</span><span class="st">"letremy"</span>)
korresp.som</code></pre></div>
<pre><code>##       Self-Organizing Map object...
##          online learning, type: korresp 
##          8 x 8 grid with square topology
##          neighbourhood type: letremy 
##          distance type: letremy</code></pre>
<p>As the energy is registered during the intermediate backups, we can have a look at its evolution</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(korresp.som, <span class="dt">what=</span><span class="st">"energy"</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/energyPresi-1.png" width="700"></p>
<p>which is stabilized during the last 100 iterations.</p>
</div>
<div id="resulting-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#resulting-clustering" class="anchor"></a>Resulting clustering</h3>
<p>The clustering component contains the final classification of the dataset. As both row and column variables are classified, the length of the resulting vector is equal to the sum of the number of rows and the number of columns.</p>
<p><strong>NB: The clustering component shows first the column variables (here, the candidates) and then the row variables (here, the departements).</strong></p>
<p>The following table indicates which graphics are available for a korresp SOM.</p>
<table class="table">
<thead><tr class="header">
<th>Type</th>
<th align="center">Energy</th>
<th align="center">Obs</th>
<th align="center">Prototypes</th>
<th align="center">Add</th>
<th align="center">Super Cluster</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>no type</td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>hitmap</td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
</tr>
<tr class="odd">
<td>color</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x2</td>
<td align="center"></td>
<td align="center">x2</td>
</tr>
<tr class="even">
<td>lines</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x2</td>
<td align="center"></td>
<td align="center">x2</td>
</tr>
<tr class="odd">
<td>barplot</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>radar</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>pie</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>boxplot</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>3d</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x2</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>poly.dist</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center">x</td>
</tr>
<tr class="odd">
<td>umatrix</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>smooth.dist</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>words</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>names</td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>graph</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>mds</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center">x</td>
</tr>
<tr class="odd">
<td>grid.dist</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>grid</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
</tr>
<tr class="odd">
<td>dendrogram</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
</tr>
<tr class="even">
<td>dendro3d</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
</tr>
</tbody>
</table>
<p>In the column “Prototypes”, a plot marked “x2” means that this plot is available for both row and column variables. In the “Super Cluster” column, a “x2” cell means the plot is available for both data set variables and additional variables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">korresp.som<span class="op">$</span>clustering</code></pre></div>
<pre><code>##                   MEGRET                   LEPAGE               GLUCKSTEIN 
##                       15                       16                        8 
##                   BAYROU                   CHIRAC                   LE_PEN 
##                       32                       54                        9 
##                  TAUBIRA              SAINT_JOSSE                   MAMERE 
##                        6                       12                       22 
##                   JOSPIN                   BOUTIN                      HUE 
##                       57                       16                       21 
##              CHEVENEMENT                  MADELIN                LAGUILLER 
##                       22                       23                       21 
##               BESANCENOT                      ain                    aisne 
##                       21                       27                       18 
##                   allier  alpes_de_haute_provence             hautes_alpes 
##                       43                       33                       41 
##          alpes_maritimes                  ardeche                 ardennes 
##                        2                       35                       25 
##                   ariege                     aube                     aude 
##                       33                       25                       26 
##                  aveyron         bouches_du_rhone                 calvados 
##                       43                        3                       52 
##                   cantal                 charente        charente_maritime 
##                       42                       43                       52 
##                     cher                  correze                corse_sud 
##                       35                       51                       41 
##              haute_corse                cote_d'or            cotes_d'armor 
##                       41                       27                       44 
##                   creuse                 dordogne                    doubs 
##                       42                       43                       27 
##                    drome                     eure             eure_et_loir 
##                       26                       18                       26 
##                finistere                     gard            haute_garonne 
##                       61                       18                       28 
##                     gers                  gironde                  herault 
##                       34                        4                       19 
##          ille_et_vilaine                    indre          indre_et_loire_ 
##                       61                       34                       44 
##                    isere                     jura                   landes 
##                       28                       25                       43 
##             loir_et_cher                    loire              haute_loire 
##                       35                       27                       33 
##         loire_atlantique                   loiret                      lot 
##                       61                       27                       34 
##          lot_et_garonne_                   lozere          maine_et_loire_ 
##                       34                       41                       60 
##                   manche                    marne              haute_marne 
##                       52                       27                       33 
##                  mayenne       meurthe_et_moselle                    meuse 
##                       51                       27                       33 
##                 morbihan                  moselle                   nievre 
##                       52                        2                       33 
##                     nord                     oise                     orne 
##                       21                       27                       35 
##            pas_de_calais              puy_de_dome     pyrenees_atlantiques 
##                       13                       44                       52 
##          hautes_pyrenees      pyrenees_orientales                 bas_rhin 
##                       34                       26                       40 
##                haut_rhin                    rhone              haute_saone 
##                       27                       39                       25 
##          saone_et_loire_                   sarthe                   savoie 
##                       27                       44                       26 
##             haute_savoie                    paris          seine_maritime_ 
##                       27                       30                       13 
##          seine_et_marne_                 yvelines              deux_sevres 
##                       28                       48                       43 
##                    somme                     tarn          tarn_et_garonne 
##                       12                       43                       34 
##                      var                 vaucluse                   vendee 
##                        2                       18                       52 
##                   vienne             haute_vienne                   vosges 
##                       43                       43                       26 
##                    yonne    territoire_de_belfort                  essonne 
##                       26                       41                       28 
##          hauts_de_seine_        seine_saint-denis             val_de_marne 
##                       37                       28                       28 
##               val_d'oise               guadeloupe               martinique 
##                       28                        6                        6 
##                   guyane               la_reunion                  mayotte 
##                        6                       57                       41 
##       nouvelle_caledonie      polynesie_francaise saint_pierre_et_miquelon 
##                       50                       50                       41 
##         wallis_et_futuna   francais_de_l'etranger 
##                       41                       51</code></pre>
<p>The resulting distribution of the clustering on the map can also be visualized by a hitmap:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(korresp.som, <span class="dt">what=</span><span class="st">"obs"</span>, <span class="dt">type=</span><span class="st">"hitmap"</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiHitmap-1.png" width="700"></p>
<p>For a more precise view, <code>"names"</code> plot is implemented: it prints, in each neuron, the names of the variables assigned to it ; in the korresp SOM, both row and column variable names are printed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(korresp.som, <span class="dt">what=</span><span class="st">"obs"</span>, <span class="dt">type=</span><span class="st">"names"</span>, <span class="dt">scale=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="fl">0.9</span>,<span class="fl">0.5</span>))</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiGraphObs-1.png" width="1152"></p>
<p>The map is divided into two main parts: minor candidates are classified at its top left hand side whereas the first main candidates CHIRAC, LE PEN and JOSPIN are classified at the bottom right hand side of the map, in three different parts of this corner. Some strinking facts are:</p>
<ul>
<li><p>the position of TAUBIRA, opposed to that of JOSPIN from who she is very close from a political point of view. She is associated with Guyane, Guadeloupe and Martinique, overseas departements;</p></li>
<li><p>the position of HUE, LAGUILLER and BESANCENOT, far left candidates, all associated in the same cluster and close to traditional departements voting for far left candidates: Nord, Pas de Calais and Seine Maritime ;</p></li>
<li><p>the fact that most departement are classified at the bottom right hand side of the map with the three main candidates.</p></li>
</ul>
</div>
<div id="clustering-interpretation" class="section level3">
<h3 class="hasAnchor">
<a href="#clustering-interpretation" class="anchor"></a>Clustering interpretation</h3>
<p>Some graphics from the numeric SOM algorithm are still available in the korresp case. They are detailed below. As the resulting clustering provides the classification for both rows and columns, a new argument <code>view</code> is used to specify which one should be considered. Its possible values are either <code>"r"</code> for row variables (the default value) or <code>"c"</code> for column variables.</p>
<div id="graphics-on-prototype-values" class="section level4">
<h4 class="hasAnchor">
<a href="#graphics-on-prototype-values" class="anchor"></a>Graphics on prototype values</h4>
<p>Three representations are available:</p>
<ul>
<li>with lines: either all row or all column variables are plotted (<code>view</code> argument is used)</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot the line prototypes (106 French departements)</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(korresp.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"lines"</span>, <span class="dt">view=</span><span class="st">"r"</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiProtoL-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># plot the column prototypes (16 candidates)</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(korresp.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"lines"</span>, <span class="dt">view=</span><span class="st">"c"</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiProtoL-2.png" width="700"></p>
<p>The peaks in neurons 5 and 6 correspond, in the row view, to the overseas departements and, in the column view, to the candidate TAUBIRA. In the column views, the two peaks clearly identified in the bottom right side clusters correspond to the two “main” tranditional candidates JOSPIN and CHIRAC (respectively, left and right candidates).</p>
<p>A more precise individual view are given with the graphics “color” and “3d”, here drawn, as an example for the candidate “Le Pen” and for the departement “Martinique”. * in color: one of the row or column variable (the variable is chosen with the argument <code>variable</code>) is represented on the map; * in 3d, which handling is similar to <code>"color"</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>))
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(korresp.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"color"</span>, <span class="dt">variable=</span><span class="st">"TAUBIRA"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(korresp.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"3d"</span>, <span class="dt">variable=</span><span class="st">"martinique"</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiProtoC3d-1.png" width="1152"></p>
<p>The first graphic shows that TAUBIRA obtained her best scores in the departements located at the left hand side of the map. The second graphic shows that the candidates that obtained the higher scores in Martinique are located in the bottom right hand side of the map.</p>
<p>The graphics can also be drawn by giving the variable number and its type, either “r” or “c” (here, as an example, CHIRAC who is the 5th candidate):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>))
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(korresp.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"color"</span>, <span class="dt">variable=</span><span class="dv">5</span>, <span class="dt">view=</span><span class="st">"c"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(korresp.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"3d"</span>, <span class="dt">variable=</span><span class="dv">5</span>, <span class="dt">view=</span><span class="st">"c"</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiProtoNumber-1.png" width="1152"></p>
<p>Hence CHIRAC obtained more votes in departement located at the top of the map and has his lowest scores in departements Jura, Aubde, Haute Saone, Ardennes, Alpes de Haute Provence, Ariege, … located at the bottom (middle) of the map.</p>
</div>
<div id="graphic-on-prototype-distances" class="section level4">
<h4 class="hasAnchor">
<a href="#graphic-on-prototype-distances" class="anchor"></a>Graphic on prototype distances</h4>
<p>These graphics are exactly the same as in the numerical case:</p>
<ul>
<li><p><code>"poly.dist"</code> represents the distances between neighboring prototypes with polygons plotted for each cell of the grid. The smaller the distance between a polygon’s vertex and a cell border, the closer the pair of prototypes. The colors indicates the number of observations in the neuron (white=empty);</p></li>
<li><p><code>"umatrix"</code> fills the neurons of the grid using colors that represent the average distance between the current prototype and its neighbors (darker colors for prototypes that are farther from their neighbors);</p></li>
<li><p><code>"smooth.dist"</code> plots the mean distance between the current prototype and its neighbors with a color gradation;</p></li>
<li><p><code>"mds"</code> plots the number of the neuron on a map according to a Multi Dimensional Scaling (MDS) projection;</p></li>
<li><p><code>"grid.dist"</code> plots a point for each pair of prototypes, with x coordinates representing the distance between the prototypes in the input space, and y coordinates representing the distance between the corresponding neurons on the grid.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(korresp.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"poly.dist"</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiGraphProto2-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(korresp.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"umatrix"</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiGraphProto2-2.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(korresp.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"smooth.dist"</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiGraphProto2-3.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(korresp.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"mds"</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiGraphProto2-4.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(korresp.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"grid.dist"</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiGraphProto2-5.png" width="700"></p>
<p>Neuron 6 which has been already picked out in the section <strong>Clustering interpretation</strong> for having prototypes rather different than the rest of the map shows a larger distance to the others.</p>
</div>
</div>
<div id="analyze-the-projection-quality" class="section level3">
<h3 class="hasAnchor">
<a href="#analyze-the-projection-quality" class="anchor"></a>Analyze the projection quality</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/quality.html">quality</a></span>(korresp.som)</code></pre></div>
<pre><code>## $topographic
## [1] 0.1415094
## 
## $quantization
## [1] 11292.83</code></pre>
<p>By default, the quality function calculates both quantization and topographic errors. It is also possible to specify which one you want to obtain, by using the argument <code>quality.type</code>.</p>
<p>The topographic error value varies between 0 (good projection quality) and 1 (poor projection quality). Here, the topographic quality of the mapping is rather good with a topographic error equal to 0.142.</p>
<p>The quantization error is an unbounded positive number. The closer from 0 it is, the better the projection quality is.</p>
</div>
<div id="building-super-classes-from-the-resulting-som" class="section level3">
<h3 class="hasAnchor">
<a href="#building-super-classes-from-the-resulting-som" class="anchor"></a>Building super classes from the resulting SOM</h3>
<p>In the SOM algorithm, the number of clusters is necessarily close to the number of neurons on the grid (not necessarily equal as some neurons may have no observations assigned to them). This - quite large - number may not suit the original data for a clustering purpose.</p>
<p>A usual way to address clustering with SOM is to perform a hierarchical clustering on the prototypes. This clustering is directly available in the package <code>SOMbrero</code> using the function <code>superClass</code>. To do so, you can first have a quick overview to decide on the number of super clusters which suits your data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="../reference/superClass.html">superClass</a></span>(korresp.som))</code></pre></div>
<pre><code>## Warning in plot.somSC(superClass(korresp.som)): Impossible to plot the rectangles: no super clusters.</code></pre>
<p><img src="doc-korrespSOM_files/figure-html/presiSC1-1.png" width="700"></p>
<p>By default, the function plots both a dendrogram and the evolution of the percentage of explained variance. Here, 3 super clusters seem to be a good choice. The output of <code>superClass</code> is a <code>somSC</code> class object. Basic functions have been defined for this class:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my.sc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/superClass.html">superClass</a></span>(korresp.som, <span class="dt">k=</span><span class="dv">3</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(my.sc)</code></pre></div>
<pre><code>## 
##    SOM Super Classes
##      Initial number of clusters :  64 
##      Number of super clusters   :  3 
## 
## 
##   Frequency table
##  1  2  3 
## 13 24 27 
## 
##   Clustering
##  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 
##  1  1  2  2  2  2  2  2  1  1  2  2  2  2  2  2  1  1  1  2  2  2  2  2  1 
## 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 
##  1  1  3  2  2  2  2  1  1  1  3  3  2  2  2  3  3  3  3  3  3  3  3  3  3 
## 51 52 53 54 55 56 57 58 59 60 61 62 63 64 
##  3  3  3  3  3  3  3  3  3  3  3  3  3  3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">plot.var=</span><span class="ot">FALSE</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiSC2-1.png" width="700"></p>
<p>Like <code>plot.somRes</code>, the function <code>plot.somSC</code> has an argument <code>'type'</code> which offers many different plots and can thus be combined with most of the graphics produced by <code>plot.somSC</code>:</p>
<p>Case <code>"grid"</code> fills the grid with colors according to the super clustering (and can provide a legend). Case <code>"dendro3d"</code> plots a 3d dendrogram.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"grid"</span>, <span class="dt">plot.legend=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiSC3-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"dendro3d"</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiSC3-2.png" width="700"></p>
<p>The three super-clusters correspond to traditional votes (blue), far right votes (green) and votes for minor candidates (orange).</p>
<p>A couple of plots from <code>plot.somRes</code> are also available for the super clustering. Some identify the super clusters with colors:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"hitmap"</span>, <span class="dt">plot.legend=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiSC4-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"lines"</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiSC4-2.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"lines"</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>, <span class="dt">view=</span><span class="st">"c"</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiSC4-3.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"mds"</span>, <span class="dt">plot.legend=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiSC4-4.png" width="700"></p>
<p>And some others identify the super clusters with titles:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"color"</span>, <span class="dt">view=</span><span class="st">"r"</span>, <span class="dt">variable=</span><span class="st">"correze"</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiSC5-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"color"</span>, <span class="dt">view=</span><span class="st">"c"</span>, <span class="dt">variable=</span><span class="st">"JOSPIN"</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiSC5-2.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(my.sc, <span class="dt">type=</span><span class="st">"poly.dist"</span>)</code></pre></div>
<p><img src="doc-korrespSOM_files/figure-html/presiSC5-3.png" width="700"></p>
<p>Let us consider the first super cluster. It contains departements which were crucial in promoting the far right candidate LE PEN, unexpected winner of the first round:</p>
<pre><code>##  [1] "LE_PEN"                  "ain"                    
##  [3] "aisne"                   "alpes_de_haute_provence"
##  [5] "alpes_maritimes"         "ardeche"                
##  [7] "ardennes"                "ariege"                 
##  [9] "aube"                    "aude"                   
## [11] "cher"                    "cote_d'or"              
## [13] "doubs"                   "drome"                  
## [15] "eure"                    "eure_et_loir"           
## [17] "gard"                    "gers"                   
## [19] "herault"                 "indre"                  
## [21] "jura"                    "loir_et_cher"           
## [23] "loire"                   "haute_loire"            
## [25] "loiret"                  "lot"                    
## [27] "lot_et_garonne_"         "marne"                  
## [29] "haute_marne"             "meurthe_et_moselle"     
## [31] "meuse"                   "moselle"                
## [33] "nievre"                  "oise"                   
## [35] "orne"                    "hautes_pyrenees"        
## [37] "pyrenees_orientales"     "haut_rhin"              
## [39] "haute_saone"             "saone_et_loire_"        
## [41] "savoie"                  "haute_savoie"           
## [43] "tarn_et_garonne"         "var"                    
## [45] "vaucluse"                "vosges"                 
## [47] "yonne"</code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#self-organizing-map-for-contingency-tables">Self-Organizing Map for contingency tables</a><ul class="nav nav-pills nav-stacked">
<li><a href="#basic-package-description">Basic package description</a></li>
      <li><a href="#case-study-the-presidentielles2002-data-set">Case study: the <code>presidentielles2002</code> data set</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nathalie Vialaneix, Jerome Mariette, Madalina Olteanu, Fabrice Rossi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
