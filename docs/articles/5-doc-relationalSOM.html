<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Self-Organizing Map for dissimilarity matrices • SOMbrero</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Self-Organizing Map for dissimilarity matrices">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SOMbrero</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.2.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/1-doc-SOMbrero-package.html">SOMbrero Package description</a>
    </li>
    <li>
      <a href="../articles/2-doc-grids.html">A basic vignette on grids in SOMbrero</a>
    </li>
    <li>
      <a href="../articles/3-doc-numericSOM.html">Using Self-Organizing Maps with SOMbrero to cluster a numeric dataset</a>
    </li>
    <li>
      <a href="../articles/4-doc-korrespSOM.html">Self-Organizing Map for contingency tables</a>
    </li>
    <li>
      <a href="../articles/5-doc-relationalSOM.html">Self-Organizing Map for dissimilarity matrices</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Self-Organizing Map for dissimilarity matrices</h1>
            
      
      
      <div class="hidden name"><code>5-doc-relationalSOM.Rmd</code></div>

    </div>

    
    
<!--
%\VignetteEngine{knitr}
%\VignetteIndexEntry{SOM for dissimilarity data}
%\VignettePackage{SOMbrero}
-->
<div id="self-organizing-map-for-dissimilarity-matrices" class="section level1">
<h1 class="hasAnchor">
<a href="#self-organizing-map-for-dissimilarity-matrices" class="anchor"></a>Self-Organizing Map for dissimilarity matrices</h1>
<div id="basic-package-description" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-package-description" class="anchor"></a>Basic package description</h2>
<p>To be able to run the SOM algorithm, you have to load the package called <code>SOMbrero</code>. The function used to run it is called <code><a href="../reference/trainSOM.html">trainSOM()</a></code> and is detailed below.</p>
<p><strong>This documentation only considers the case of dissimilarity matrices.</strong></p>
<div id="arguments" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments" class="anchor"></a>Arguments</h3>
<p>The <code>trainSOM</code> function has several arguments, but only the first one is required. This argument is <code>x.data</code> which is the dataset used to train the SOM. In this documentation, it is passed to the function as a matrix or a data frame. This set must be a dissimilarity matrix, i.e., a symmetric matrix of positive numbers, with zero entries on the diagonal.</p>
<p>The other arguments are the same as the arguments passed to the <code>initSOM</code> function (they are parameters defining the algorithm, see <code><a href="https://www.rdocumentation.org/packages/utils/topics/help">help(initSOM)</a></code> for further details).</p>
</div>
<div id="outputs" class="section level3">
<h3 class="hasAnchor">
<a href="#outputs" class="anchor"></a>Outputs</h3>
<p>The <code>trainSOM</code> function returns an object of class <code>somRes</code> (see <code><a href="https://www.rdocumentation.org/packages/utils/topics/help">help(trainSOM)</a></code> for further details on this class).</p>
</div>
<div id="graphics" class="section level3">
<h3 class="hasAnchor">
<a href="#graphics" class="anchor"></a>Graphics</h3>
<p>The following table indicates which graphics are available for a relational SOM.</p>
<table class="table">
<thead><tr class="header">
<th>Type</th>
<th align="center">Energy</th>
<th align="center">Obs</th>
<th align="center">Prototypes</th>
<th align="center">Add</th>
<th align="center">Super Cluster</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>no type</td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>hitmap</td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
</tr>
<tr class="odd">
<td>color</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
</tr>
<tr class="even">
<td>lines</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center">x</td>
<td align="center">x2</td>
</tr>
<tr class="odd">
<td>barplot</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center">x</td>
<td align="center">x2</td>
</tr>
<tr class="even">
<td>radar</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center">x</td>
<td align="center">x2</td>
</tr>
<tr class="odd">
<td>pie</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center">x2</td>
</tr>
<tr class="even">
<td>boxplot</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>3d</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>poly.dist</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center">x</td>
</tr>
<tr class="odd">
<td>umatrix</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>smooth.dist</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>words</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
</tr>
<tr class="even">
<td>names</td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
</tr>
<tr class="odd">
<td>graph</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center">x</td>
</tr>
<tr class="even">
<td>mds</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center">x</td>
</tr>
<tr class="odd">
<td>grid.dist</td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
<td align="center"></td>
<td align="center"></td>
</tr>
<tr class="even">
<td>grid</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
</tr>
<tr class="odd">
<td>dendrogram</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
</tr>
<tr class="even">
<td>dendro3d</td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center"></td>
<td align="center">x</td>
</tr>
</tbody>
</table>
<p>In the “Super Cluster” column, a plot marked by “x2” means it is available for both data set variables and additional variables.</p>
</div>
</div>
<div id="case-study-the-lesmis-data-set" class="section level2">
<h2 class="hasAnchor">
<a href="#case-study-the-lesmis-data-set" class="anchor"></a>Case study: the <code>lesmis</code> data set</h2>
<p>The <code>lesmis</code> data set provides the coappearance graph of the characters of the novel Les Miserables (Victor Hugo). Each vertex stands for a character whose name is given by the vertex label. One edge means that the corresponding two characters appear in a common chapter in the book. Each edge also has a value indicating the number of coappearances. The <code>lesmis</code> data contain two objects: the first one <code>lesmis</code> is an <code>igraph</code> object (see <a href="http://igraph.sourceforge.net/">the igraph web page</a>), with 77 nodes and 254 edges.</p>
<p>Further information on this data set is provided with <code><a href="https://www.rdocumentation.org/packages/utils/topics/help">help(lesmis)</a></code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(lesmis)
lesmis</code></pre></div>
<pre><code>## IGRAPH 3babff7 U--- 77 254 -- 
## + attr: layout (g/n), id (v/n), label (v/c), value (e/n)
## + edges from 3babff7:
##  [1]  1-- 2  1-- 3  1-- 4  3-- 4  1-- 5  1-- 6  1-- 7  1-- 8  1-- 9  1--10
## [11] 11--12  4--12  3--12  1--12 12--13 12--14 12--15 12--16 17--18 17--19
## [21] 18--19 17--20 18--20 19--20 17--21 18--21 19--21 20--21 17--22 18--22
## [31] 19--22 20--22 21--22 17--23 18--23 19--23 20--23 21--23 22--23 17--24
## [41] 18--24 19--24 20--24 21--24 22--24 23--24 13--24 12--24 24--25 12--25
## [51] 25--26 24--26 12--26 25--27 12--27 17--27 26--27 12--28 24--28 26--28
## [61] 25--28 27--28 12--29 28--29 24--30 28--30 12--30 24--31 31--32 12--32
## [71] 24--32 28--32 12--33 12--34 28--34 12--35 30--35 12--36 35--36 30--36
## + ... omitted several edges</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(lesmis, <span class="dt">vertex.size=</span><span class="dv">0</span>)</code></pre></div>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisDescr-1.png" width="1152"></p>
<p>The <code>dissim.lesmis</code> object is a matrix with entries equal to the length of the shortest path between two characters (obtained with the function <code>shortest.paths</code> of package <code>igraph</code>). Note that its row and column names have been initialized to the characters’ names to ease the use of the graphical functions of <code>SOMbrero</code>.</p>
<div id="training-the-som" class="section level3">
<h3 class="hasAnchor">
<a href="#training-the-som" class="anchor"></a>Training the SOM</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Random">set.seed</a></span>(<span class="dv">622</span>)
mis.som &lt;-<span class="st"> </span><span class="kw"><a href="../reference/trainSOM.html">trainSOM</a></span>(<span class="dt">x.data=</span>dissim.lesmis, <span class="dt">type=</span><span class="st">"relational"</span>, <span class="dt">nb.save=</span><span class="dv">10</span>,
                   <span class="dt">init.proto=</span><span class="st">"random"</span>, <span class="dt">radius.type=</span><span class="st">"letremy"</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(mis.som, <span class="dt">what=</span><span class="st">"energy"</span>)</code></pre></div>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisTrain-1.png" width="700"></p>
<p>The dissimilarity matrix <code>dissim.lesmis</code> is passed to the <code>trainSOM</code> function as input. As the SOM intermediate backups have been registered (<code>nb.save=10</code>), the energy evolution can be plotted: it stabilized in the last 100 iterations.</p>
</div>
<div id="resulting-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#resulting-clustering" class="anchor"></a>Resulting clustering</h3>
<p>The clustering component provides the classification of each of the 77 characters. The <code>table</code> function is a simple way to view data distribution on the map.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mis.som<span class="op">$</span>clustering</code></pre></div>
<pre><code>##           Myriel         Napoleon   MlleBaptistine      MmeMagloire 
##                5                5                4                4 
##     CountessDeLo         Geborand     Champtercier         Cravatte 
##                5                5                5                5 
##            Count           OldMan          Labarre          Valjean 
##                5                5                2                2 
##       Marguerite           MmeDeR          Isabeau          Gervais 
##                2                6                1                7 
##        Tholomyes        Listolier          Fameuil      Blacheville 
##               21               21               21               21 
##        Favourite           Dahlia          Zephine          Fantine 
##               21               21               21               22 
##    MmeThenardier       Thenardier          Cosette           Javert 
##               18               23               13               17 
##     Fauchelevent       Bamatabois         Perpetue         Simplice 
##                1               11               22               17 
##      Scaufflaire           Woman1            Judge     Champmathieu 
##                3                1               11               11 
##           Brevet       Chenildieu      Cochepaille        Pontmercy 
##               11               11               11               19 
##     Boulatruelle          Eponine          Anzelma           Woman2 
##               23               23               23                3 
##   MotherInnocent          Gribier        Jondrette        MmeBurgon 
##                1                1               15               15 
##         Gavroche     Gillenormand           Magnon MlleGillenormand 
##               20               13               18               13 
##     MmePontmercy      MlleVaubois   LtGillenormand           Marius 
##               13               13               13               19 
##        BaronessT           Mabeuf         Enjolras       Combeferre 
##               19               25               25               25 
##        Prouvaire          Feuilly       Courfeyrac          Bahorel 
##               25               25               25               25 
##          Bossuet             Joly        Grantaire   MotherPlutarch 
##               25               25               20               25 
##        Gueulemer            Babet       Claquesous     Montparnasse 
##               23               23               23               23 
##        Toussaint           Child1           Child2           Brujon 
##                7               15               15               23 
##     MmeHucheloup 
##               20</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/table">table</a></span>(mis.som<span class="op">$</span>clustering)</code></pre></div>
<pre><code>## 
##  1  2  3  4  5  6  7 11 13 15 17 18 19 20 21 22 23 25 
##  5  3  2  2  8  1  2  6  6  4  2  2  3  3  7  2  9 10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(mis.som)</code></pre></div>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisClustering-1.png" width="700"></p>
<p>The clustering can be displayed using the <code>plot</code> function with <code>type=names</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(mis.som, <span class="dt">what=</span><span class="st">"obs"</span>, <span class="dt">type=</span><span class="st">"names"</span>)</code></pre></div>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisPseudoNamesPlot-1.png" width="1152"></p>
<p>or by sur-imposing the original igraph object on the map:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(mis.som, <span class="dt">what=</span><span class="st">"add"</span>, <span class="dt">type=</span><span class="st">"graph"</span>, <span class="dt">var=</span>lesmis)</code></pre></div>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisProjGraph-1.png" width="700"></p>
<p>Clusters profile overviews can be plotted either with <em>e.g.</em>, lines or radar.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(mis.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"lines"</span>)</code></pre></div>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisProtoProfiles-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(mis.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"radar"</span>)</code></pre></div>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisProtoProfiles-2.png" width="700"></p>
<p>On these graphics, one variable is represented respectively with a point or a slice. It is therefore easy to see which variable affects which cluster.</p>
<p>To see how different the clusters are, some graphics show the distances between prototypes. These graphics have exactly the same behaviour as in the other SOM types.</p>
<ul>
<li><p><code>"poly.dist"</code> represents the distances between neighboring prototypes with polygons plotted for each cell of the grid. The smaller the distance between a polygon’s vertex and a cell border, the closer the pair of prototypes. The colors indicates the number of observations in the neuron (white is used for empty neurons);</p></li>
<li><p><code>"umatrix"</code> fills the neurons of the grid using colors that represent the average distance between the current prototype and its neighbors;</p></li>
<li><p><code>"smooth.dist"</code> plots the mean distance between the current prototype and its neighbors with a color gradation;</p></li>
<li><p><code>"mds"</code> plots the number of the neuron on a map according to a Multi Dimensional Scaling (MDS) projection;</p></li>
<li><p><code>"grid.dist"</code> plots a point for each pair of prototypes, with x coordinates representing the distance between the prototypes in the input space, and y coordinates representing the distance between the corresponding neurons on the grid.</p></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(mis.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"poly.dist"</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisProtoDist-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(mis.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"smooth.dist"</span>)</code></pre></div>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisProtoDist-2.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(mis.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"umatrix"</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisProtoDist-3.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(mis.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"mds"</span>)</code></pre></div>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisProtoDist-4.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(mis.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"grid.dist"</span>)</code></pre></div>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisProtoDist-5.png" width="700"></p>
<p>Here we can see that the prototypes located in the top left corner of the map (<em>e.g.</em>, clusters 4 and 5) are far from the others.</p>
<p>Finally, with a graphical overview of the clustering</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(lesmis, <span class="dt">vertex.label.color=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/palettes">rainbow</a></span>(<span class="dv">25</span>)[mis.som<span class="op">$</span>clustering], <span class="dt">vertex.size=</span><span class="dv">0</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/legend">legend</a></span>(<span class="dt">x=</span><span class="st">"left"</span>, <span class="dt">legend=</span><span class="dv">1</span><span class="op">:</span><span class="dv">25</span>, <span class="dt">col=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/palettes">rainbow</a></span>(<span class="dv">25</span>), <span class="dt">pch=</span><span class="dv">19</span>)</code></pre></div>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisColorOverview-1.png" width="1152"></p>
<p>We can see that cluster 5 is very relevant to the story: as the characters of this cluster appear only in the sub-story of the Bishop <code>Myriel</code>, he is the only connection for all other characters of cluster 5. The same kind of conclusion holds for cluster 11, among others. Most of the other clusters have a small number of observations: it thus seems relevant to compute super clusters.</p>
</div>
<div id="compute-super-clusters" class="section level3">
<h3 class="hasAnchor">
<a href="#compute-super-clusters" class="anchor"></a>Compute super clusters</h3>
<p>As the number of clusters is quite important with the SOM algorithm, it is possible to perform a hierarchical clustering. First, let us have an overview of the dendrogram:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw"><a href="../reference/superClass.html">superClass</a></span>(mis.som))</code></pre></div>
<pre><code>## Warning in plot.somSC(superClass(mis.som)): Impossible to plot the rectangles: no super clusters.</code></pre>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisSCOverview-1.png" width="700"></p>
<p>According to the proportion of variance explained by super clusters, 5 groups seem to be a good choice.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sc.mis &lt;-<span class="st"> </span><span class="kw"><a href="../reference/superClass.html">superClass</a></span>(mis.som, <span class="dt">k=</span><span class="dv">5</span>)
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(sc.mis)</code></pre></div>
<pre><code>## 
##    SOM Super Classes
##      Initial number of clusters :  25 
##      Number of super clusters   :  5 
## 
## 
##   Frequency table
## 1 2 3 4 5 
## 9 2 4 6 4 
## 
##   Clustering
##  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 
##  1  1  1  2  2  1  1  1  1  3  1  1  4  4  3  5  5  4  4  3  5  5  4  4  3 
## 
## 
##   ANOVA
##          F                       :  10.09429 
##          Degrees of freedom      :  4 
##          p-value                 :  1.526375e-06 
##                  significativity :  ***</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/table">table</a></span>(sc.mis<span class="op">$</span>cluster)</code></pre></div>
<pre><code>## 
## 1 2 3 4 5 
## 9 2 4 6 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(sc.mis)</code></pre></div>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisSC-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(sc.mis, <span class="dt">type=</span><span class="st">"grid"</span>, <span class="dt">plot.legend=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisSC-2.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(sc.mis, <span class="dt">type=</span><span class="st">"lines"</span>, <span class="dt">print.title=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisSC-3.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(sc.mis, <span class="dt">type=</span><span class="st">"mds"</span>, <span class="dt">plot.legend=</span><span class="ot">TRUE</span>)</code></pre></div>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisSC-4.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(sc.mis, <span class="dt">type=</span><span class="st">"dendro3d"</span>)</code></pre></div>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisSC-5.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(RColorBrewer)
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(lesmis, <span class="dt">vertex.size=</span><span class="dv">0</span>, <span class="dt">vertex.label.color=</span>
       <span class="kw"><a href="https://www.rdocumentation.org/packages/RColorBrewer/topics/ColorBrewer">brewer.pal</a></span>(<span class="dv">6</span>, <span class="st">"Set2"</span>)[sc.mis<span class="op">$</span>cluster[mis.som<span class="op">$</span>clustering]])
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/legend">legend</a></span>(<span class="dt">x=</span><span class="st">"left"</span>, <span class="dt">legend=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/paste">paste</a></span>(<span class="st">"SC"</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>), <span class="dt">col=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/RColorBrewer/topics/ColorBrewer">brewer.pal</a></span>(<span class="dv">5</span>, <span class="st">"Set2"</span>), <span class="dt">pch=</span><span class="dv">19</span>)</code></pre></div>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisSCColorOverview-1.png" width="1152"></p>
<ul>
<li><p>cluster 1 constains <code>Valjean</code> which has a central position in the MDS visualization;</p></li>
<li><p>cluster 2 contains <code>Myriel</code> and the characters involved in his sub-story;</p></li>
<li><p>cluster 3 contains <code>Gavroche</code>, the abandonned child of the <code>Thenardier</code>, and the characters of his sub-story;</p></li>
<li><p>cluster 4 countains the Thenardier family: mister and misses <code>Thenardier</code>, their daughter <code>Eponine</code> and also the characters involved in their story. It also contains <code>Javert</code> who is seeking to find the main character of the story, <code>Valjean</code>, and <code>Marius</code>. All these characters are strongly related to <code>Cosette</code> who is <code>Marius</code>’s lover and has lived in the <code>Thenardier</code> family during her childhood;</p></li>
<li><p>cluster 5 countains <code>Fantine</code> and the characters involved in her sub-story.</p></li>
</ul>
<p>SOMbrero also contains functions to compute a projected graph based on the super-clusters and to display it:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/projectIGraph.somRes.html">projectIGraph</a></span>(sc.mis, lesmis)</code></pre></div>
<pre><code>## IGRAPH 1170003 UNW- 5 7 -- 
## + attr: layout (g/n), name (v/c), size (v/n), weight (e/n)
## + edges from 1170003 (vertex names):
## [1] 1--2 1--3 1--4 1--5 3--4 3--5 4--5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/par">par</a></span>(<span class="dt">mar=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">0</span>,<span class="dv">4</span>))
<span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(sc.mis, <span class="dt">type=</span><span class="st">"projgraph"</span>, <span class="dt">variable=</span>lesmis, <span class="dt">s.radius=</span><span class="dv">2</span>)</code></pre></div>
<p><img src="5-doc-relationalSOM_files/figure-html/lesmisSCProjGraph-1.png" width="700"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#self-organizing-map-for-dissimilarity-matrices">Self-Organizing Map for dissimilarity matrices</a><ul class="nav nav-pills nav-stacked">
<li><a href="#basic-package-description">Basic package description</a></li>
      <li><a href="#case-study-the-lesmis-data-set">Case study: the <code>lesmis</code> data set</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Nathalie Vialaneix, Jerome Mariette, Madalina Olteanu, Fabrice Rossi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
