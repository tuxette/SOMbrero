<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Using Self-Organizing Maps with SOMbrero to cluster a numeric dataset • SOMbrero</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Using Self-Organizing Maps with SOMbrero to cluster a numeric dataset">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SOMbrero</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/a-doc-SOMbrero-package.html">SOMbrero Package description</a>
    </li>
    <li>
      <a href="../articles/b-doc-grids.html">A basic vignette on grids in SOMbrero</a>
    </li>
    <li>
      <a href="../articles/c-doc-numericSOM.html">Using Self-Organizing Maps with SOMbrero to cluster a numeric dataset</a>
    </li>
    <li>
      <a href="../articles/d-doc-korrespSOM.html">Using Self-Organizing Maps with SOMbrero for contingency tables</a>
    </li>
    <li>
      <a href="../articles/e-doc-relationalSOM.html">Using Self-Organizing Maps with SOMbrero for dissimilarity matrices</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Using Self-Organizing Maps with SOMbrero to cluster a numeric dataset</h1>
            
            <h4 class="date">28 mai, 2020</h4>
      
      
      <div class="hidden name"><code>c-doc-numericSOM.Rmd</code></div>

    </div>

    
    
<!--
%\VignetteEngine{knitr}
%\VignetteIndexEntry{SOM for numeric data}
%\VignettePackage{SOMbrero}
-->
<p>To limit this documentation size, most figures are not displayed in the version of the vignette included in the package. To see all figures, you can rerun the vignettes, changing the following option to <code>TRUE</code>:</p>
<p>Alternatively, this compilation is also available at: <a href="http://sombrero.nathalievialaneix.eu/articles/c-doc-numericSOM.html" class="uri">http://sombrero.nathalievialaneix.eu/articles/c-doc-numericSOM.html</a></p>
<div id="basic-package-description" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-package-description" class="anchor"></a>Basic package description</h2>
<p><code>SOMbrero</code> implements different variants of the Self-Organizing Map algorithm (also called Kohonen’s algorithm). To run the standard version of the algorithm, use the function <code><a href="../reference/trainSOM.html">trainSOM()</a></code> on a data frame or matrix with numerical columns. The standard numeric SOM and its use in <code>SOMbrero</code> are illustrated below.</p>
<p><strong>This documentation only considers the case of numerical data.</strong></p>
<div id="arguments" class="section level3">
<h3 class="hasAnchor">
<a href="#arguments" class="anchor"></a>Arguments</h3>
<p>The <code>trainSOM</code> function has several arguments, but only the first one is required. This argument is <code>x.data</code> which is the dataset used to train the SOM. In this documentation, it is passed to the function as a matrix or a data frame with numerical variables in columns and observations of these variables in rows.</p>
<p>The other arguments are the same as the arguments passed to the <code>initSOM</code> function (they are parameters defining the algorithm, see <code><a href="https://rdrr.io/r/utils/help.html">help(initSOM)</a></code> for further details).</p>
</div>
<div id="outputs" class="section level3">
<h3 class="hasAnchor">
<a href="#outputs" class="anchor"></a>Outputs</h3>
<p>The <code>trainSOM</code> function returns an object of class <code>somRes</code> (see <code><a href="https://rdrr.io/r/utils/help.html">help(trainSOM)</a></code> for further details on this class).</p>
</div>
<div id="graphics" class="section level3">
<h3 class="hasAnchor">
<a href="#graphics" class="anchor"></a>Graphics</h3>
<p>The following table indicates which graphics are available for a numeric SOM.</p>
<table class="table">
<colgroup>
<col width="15%">
<col width="10%">
<col width="6%">
<col width="15%">
<col width="6%">
<col width="16%">
<col width="6%">
<col width="15%">
<col width="6%">
</colgroup>
<thead><tr class="header">
<th align="left">What <br><br> SOM or SC<br>Type</th>
<th align="left">SOM<br>Energy <br><br><br>
</th>
<th align="left">Obs <br><br><br><br>
</th>
<th align="left">Prototypes <br><br><br><br>
</th>
<th align="left">Add <br><br><br><br>
</th>
<th align="left">SuperCluster<br>(no what) <br><br><br>
</th>
<th align="left">Obs <br><br><br><br>
</th>
<th align="left">Prototypes <br><br><br><br>
</th>
<th align="left">Add <br><br><br><br>
</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">(no type)</td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">hitmap</td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">color</td>
<td align="left"></td>
<td align="left">x</td>
<td align="left">x</td>
<td align="left">x</td>
<td align="left"></td>
<td align="left">x</td>
<td align="left">x</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">lines</td>
<td align="left"></td>
<td align="left">x</td>
<td align="left">x</td>
<td align="left">x</td>
<td align="left"></td>
<td align="left">x</td>
<td align="left">x</td>
<td align="left">x</td>
</tr>
<tr class="odd">
<td align="left">meanline</td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left">x</td>
</tr>
<tr class="even">
<td align="left">barplot</td>
<td align="left"></td>
<td align="left">x</td>
<td align="left">x</td>
<td align="left">x</td>
<td align="left"></td>
<td align="left">x</td>
<td align="left">x</td>
<td align="left">x</td>
</tr>
<tr class="odd">
<td align="left">pie</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
</tr>
<tr class="even">
<td align="left">boxplot</td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left">x</td>
</tr>
<tr class="odd">
<td align="left">3d</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">poly.dist</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">umatrix</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">smooth.dist</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">mds</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">grid.dist</td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">words</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">names</td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">grid</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">dendrogram</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">dendro3d</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
<td align="left">x</td>
<td align="left"></td>
<td align="left"></td>
<td align="left"></td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="first-case-study-simulated-data-in-012" class="section level2">
<h2 class="hasAnchor">
<a href="#first-case-study-simulated-data-in-012" class="anchor"></a>First case study: simulated data in <span class="math inline">\([0,1]^2\)</span>
</h2>
<p>The first case study shows the clustering of points randomly distributed in the square <span class="math inline">\([0,1]^2\)</span>. The data are generated by:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">4031719</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">the.data &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="st">"x1"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="dv">500</span>), <span class="st">"x2"</span> =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span>(<span class="dv">500</span>))</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">ggplot</span>(the.data, <span class="kw">aes</span>(<span class="dt">x =</span> x1, <span class="dt">y =</span> x2)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>() <span class="op">+</span><span class="st"> </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/dataGeneration-1.png" width="700"></p>
<div id="training-the-som" class="section level3">
<h3 class="hasAnchor">
<a href="#training-the-som" class="anchor"></a>Training the SOM</h3>
<p>The numeric SOM algorithm is used to cluster the data:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">1105</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co"># run the SOM algorithm with 10 intermediate backups and 2000 iterations</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">my.som &lt;-<span class="st"> </span><span class="kw"><a href="../reference/trainSOM.html">trainSOM</a></span>(<span class="dt">x.data=</span>the.data, <span class="dt">dimension=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">5</span>,<span class="dv">5</span>), <span class="dt">nb.save=</span><span class="dv">10</span>, <span class="dt">maxit=</span><span class="dv">2000</span>, </a>
<a class="sourceLine" id="cb2-4" data-line-number="4">                   <span class="dt">scaling=</span><span class="st">"none"</span>, <span class="dt">radius.type=</span><span class="st">"letremy"</span>, <span class="dt">topo=</span><span class="st">"square"</span>,</a>
<a class="sourceLine" id="cb2-5" data-line-number="5">                   <span class="dt">dist.type =</span> <span class="st">"letremy"</span>)</a></code></pre></div>
<p>The energy evolves as described in the following graphic:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(my.som, <span class="dt">what=</span><span class="st">"energy"</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/energy-1.png" width="700"></p>
</div>
<div id="clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#clustering" class="anchor"></a>Clustering</h3>
<p>The resulting clustering distribution can be visualized by the hitmap:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(my.som, <span class="dt">what =</span> <span class="st">"obs"</span>, <span class="dt">type =</span> <span class="st">"hitmap"</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/hitmapObs-1.png" width="576"></p>
<p>The observations are almost uniformly distributed on the map.</p>
<p>The clustering component allows us to plot the initial data according to the final clustering.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="co"># prepare a vector of colors</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">my.colors &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/grDevices/palettes.html">rainbow</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/prod.html">prod</a></span>(my.som<span class="op">$</span>parameters<span class="op">$</span>the.grid<span class="op">$</span>dim))[my.som<span class="op">$</span>clustering]</a>
<a class="sourceLine" id="cb5-3" data-line-number="3"></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co"># points depicted with the same color are in the same final cluster</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(my.som<span class="op">$</span>data[,<span class="dv">1</span>], my.som<span class="op">$</span>data[,<span class="dv">2</span>], <span class="dt">col=</span>my.colors, <span class="dt">pch=</span><span class="dv">19</span>, <span class="dt">xlab=</span><span class="st">"x1"</span>, </a>
<a class="sourceLine" id="cb5-6" data-line-number="6">     <span class="dt">ylab=</span><span class="st">"x2"</span>, <span class="dt">main=</span><span class="st">"Data according to final clustering"</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/clusteredData-1.png" width="700"></p>
</div>
<div id="clustering-interpretation" class="section level3">
<h3 class="hasAnchor">
<a href="#clustering-interpretation" class="anchor"></a>Clustering interpretation</h3>
<p>The values of the prototypes can be represented with the plot function and help interpret the clusters:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(my.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"color"</span>, <span class="dt">var=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/colorProto-1.png" width="480"></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(my.som, <span class="dt">what=</span><span class="st">"prototypes"</span>, <span class="dt">type=</span><span class="st">"color"</span>, <span class="dt">var=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/colorProto-2.png" width="480"></p>
<p>Here, the interpretation is simple enough: high values of the first variables x1 are located at the top of the map and small values at the bottom of the map. Large values of x2 are located at the right hand side of the map, whereas, small values are located at the left hand side.</p>
<p>We obtain the same results with a similar plot on the observation mean values:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb8-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(my.som, <span class="dt">what=</span><span class="st">"obs"</span>, <span class="dt">type=</span><span class="st">"color"</span>, <span class="dt">var=</span><span class="dv">1</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/colorObs-1.png" width="480"></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(my.som, <span class="dt">what=</span><span class="st">"obs"</span>, <span class="dt">type=</span><span class="st">"color"</span>, <span class="dt">var=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/colorObs-2.png" width="480"></p>
<p>The prototypes coordinates are also registered for each intermediate backup so they can be displayed on different graphics to see the evolution in the prototypes organization. <img src="c-doc-numericSOM_files/figure-html/protoEvoluation-1.png" width="1440"></p>
<p>At the begining of the algorithm, the prototypes are randomly distributed in [0,1]^2 and then, they organize as a regular rectangular grid in <span class="math inline">\([0,1]^2\)</span>.</p>
</div>
</div>
<div id="second-case-study-the-iris-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#second-case-study-the-iris-dataset" class="anchor"></a>Second case study: the iris dataset</h2>
<p>This second case study is performed on the famous (Fisher’s or Anderson’s) iris data set that gives the measurements in centimeters of the variables sepal length and width and petal length and width, respectively, for 50 flowers from each of 3 species of iris (setosa, versicolor, and virginica).</p>
<div id="training-the-som-1" class="section level3">
<h3 class="hasAnchor">
<a href="#training-the-som-1" class="anchor"></a>Training the SOM</h3>
<p><strong>NB: In the following analysis, variables are centered and scaled to unit variance, which is the default behavior of the algorithm.</strong></p>
<p>The first four variables of the data set (that are the numeric variables) are used to map each flower on the SOM grid.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">255</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co"># run the SOM algorithm with verbose set to TRUE</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">iris.som &lt;-<span class="st"> </span><span class="kw"><a href="../reference/trainSOM.html">trainSOM</a></span>(<span class="dt">x.data =</span> iris[,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>], <span class="dt">dimension =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">5</span>,<span class="dv">5</span>), <span class="dt">verbose =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb10-4" data-line-number="4">                     <span class="dt">nb.save =</span> <span class="dv">5</span>, <span class="dt">topo =</span> <span class="st">"hexagonal"</span>)</a></code></pre></div>
<pre><code>## Self-Organizing Map algorithm...
## 
##   Parameters of the SOM
## 
##     SOM mode                       :  online 
##     SOM type                       :  numeric 
##     Affectation type               :  standard 
##     Grid                           : 
##       Self-Organizing Map structure
## 
##         Features   :
##            topology     :  hexagonal 
##            x dimension  :  5 
##            y dimension  :  5 
##            distance type:  euclidean 
## 
##     Number of iterations           :  750 
##     Number of intermediate backups :  5 
##     Initializing prototypes method :  random 
##     Data pre-processing type       :  unitvar 
##     Neighbourhood type             :  gaussian 
## 
## 0 % done
## 10 % done
## 20 % done
## 30 % done
## 40 % done
## 50 % done
## 60 % done
## 70 % done
## 80 % done
## 90 % done
## 100 % done</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">iris.som</a></code></pre></div>
<pre><code>##       Self-Organizing Map object...
##          online learning, type: numeric 
##          5 x 5 grid with hexagonal topology
##          neighbourhood type: gaussian 
##          distance type: euclidean</code></pre>
<p>As the energy is registered during the intermediate backups, we can have a look at its evolution.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"energy"</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/energyIris-1.png" width="700"></p>
<p>Here the energy does not stabilize as in the case of <code>dist.type="letremy"</code> because the Gaussian annealing of the neighbourhood is continuous and not stepwise.</p>
</div>
<div id="resulting-clustering" class="section level3">
<h3 class="hasAnchor">
<a href="#resulting-clustering" class="anchor"></a>Resulting clustering</h3>
<p>The clustering component contains the final classification of the dataset. It is a vector with length equal to the number of rows of the input dataset.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">iris.som<span class="op">$</span>clustering</a></code></pre></div>
<pre><code>##   1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18 
##   5   5   5   5   5   5   5   5   5   5   5   5   5   5   5   5   5   5 
##  19  20  21  22  23  24  25  26  27  28  29  30  31  32  33  34  35  36 
##   5   5   5   5   5   5   5   4   5   5   5   5   5   5   5   5   5   5 
##  37  38  39  40  41  42  43  44  45  46  47  48  49  50  51  52  53  54 
##   5   5   5   5   5   2   5   5   5   5   5   5   5   5  23  23  21   6 
##  55  56  57  58  59  60  61  62  63  64  65  66  67  68  69  70  71  72 
##  16   6  23   1  23   1   1  18   6  17   1  23  17   1  11   1  23  11 
##  73  74  75  76  77  78  79  80  81  82  83  84  85  86  87  88  89  90 
##  16  11  17  23  21  21  17   1   1   1   6  16  12  25  23  11  12   6 
##  91  92  93  94  95  96  97  98  99 100 101 102 103 104 105 106 107 108 
##   6  18   6   1   6  12   6  17   1   6  21  16  21  21  21  21   6  21 
## 109 110 111 112 113 114 115 116 117 118 119 120 121 122 123 124 125 126 
##  21  21  21  21  21  16  21  21  21  21  21  11  21  16  21  21  21  21 
## 127 128 129 130 131 132 133 134 135 136 137 138 139 140 141 142 143 144 
##  16  22  21  21  21  21  21  16  16  21  21  21  22  21  21  21  16  21 
## 145 146 147 148 149 150 
##  21  21  21  21  21  22</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/table.html">table</a></span>(iris.som<span class="op">$</span>clustering)</a></code></pre></div>
<pre><code>## 
##  1  2  4  5  6 11 12 16 17 18 21 22 23 25 
## 11  1  1 48 11  5  3 10  5  2 41  3  8  1</code></pre>
<p>which can also be visualized by a hitmap plot:</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what=</span><span class="st">"obs"</span>, <span class="dt">type=</span><span class="st">"hitmap"</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisHitmap-1.png" width="700"></p>
<p>To assess the relevance of each explanatory variable in the definition of the clusters, the function <code>summary</code> includes an ANOVA with the predictor being the clustering, for each (numeric) input variable.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(iris.som)</a></code></pre></div>
<pre><code>## 
## Summary
## 
##       Class :  somRes 
## 
##       Self-Organizing Map object...
##          online learning, type: numeric 
##          5 x 5 grid with hexagonal topology
##          neighbourhood type: gaussian 
##          distance type: euclidean 
## 
##       Final energy     : 1.091265 
##       Topographic error: 0.1466667 
## 
##       ANOVA                : 
## 
##         Degrees of freedom :  13 
## 
##                    F pvalue significativity
## Sepal.Length  43.463      0             ***
## Sepal.Width   17.240      0             ***
## Petal.Length 298.228      0             ***
## Petal.Width  173.062      0             ***</code></pre>
<p>Here, all variables have significantly different means among the different clusters and can thus be considered to be relevant for the clustering definition.</p>
<p>Another useful function is <code>predict.somRes</code>. This function predicts the neuron to which a new observation would be assigned. The first argument must be a <code>somRes</code> object and the second one the new observation. Let us have a try on the first observation of the iris data set:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1"><span class="co"># call predict.somRes</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(iris.som, iris[<span class="dv">1</span>,<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>])</a></code></pre></div>
<pre><code>## 5 
## 5</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1"><span class="co"># check the result of the final clustering with the SOM algorithm</span></a>
<a class="sourceLine" id="cb24-2" data-line-number="2">iris.som<span class="op">$</span>clustering[<span class="dv">1</span>]</a></code></pre></div>
<pre><code>## 1 
## 5</code></pre>
</div>
<div id="clustering-interpretation-1" class="section level3">
<h3 class="hasAnchor">
<a href="#clustering-interpretation-1" class="anchor"></a>Clustering interpretation</h3>
<div id="graphics-common-to-observations-and-prototypes" class="section level4">
<h4 class="hasAnchor">
<a href="#graphics-common-to-observations-and-prototypes" class="anchor"></a>Graphics common to observations and prototypes</h4>
<p>Some graphics are shared between observations and prototypes and can be used to display the prototypes’ or the observations’ values for the different variables in the neurons of the map. For observations, the mean values are sometimes displayed instead of the individual values.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mfrow =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb26-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"obs"</span>, <span class="dt">type =</span> <span class="st">"color"</span>, <span class="dt">variable =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisGraphOP-1.png" width="700"></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"obs"</span>, <span class="dt">type =</span> <span class="st">"color"</span>, <span class="dt">variable =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisGraphOP-2.png" width="700"></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"obs"</span>, <span class="dt">type =</span> <span class="st">"color"</span>, <span class="dt">variable =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisGraphOP-3.png" width="700"></p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"obs"</span>, <span class="dt">type =</span> <span class="st">"color"</span>, <span class="dt">variable =</span> <span class="dv">4</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisGraphOP-4.png" width="700"></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"prototypes"</span>, <span class="dt">type =</span> <span class="st">"lines"</span>, <span class="dt">show.names =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisGraphOP2-1.png" width="700"></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"obs"</span>, <span class="dt">type =</span> <span class="st">"barplot"</span>, <span class="dt">show.names =</span> <span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_blank</span>())</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisGraphOP2-2.png" width="700"></p>
<p>Some neurons are empty (no observations affected to them): neurons 3, 7, 8, 9, 10, 13, 14, 15, 19, 20, 24. They are the illustration of a large difference between observations classified in clusters 4-5 with the rest of the observations (to some extend, the same can be said about observations in cluster 25).</p>
<p>Clusters 4-5 are characterized by the following facts (visible on <code>"color"</code> plots): larger values for <code>Sepal.Width</code>, smaller values for <code>Petal.Length</code> and <code>Petal.Width</code> and average values for <code>Sepal.Length</code>. Similar conclusions are obtained from the <code>"lines"</code> and <code>"barplot"</code> plots. Please note that, for these two last plots, it is advised to display the neuron numbers (option <code>show.names = TRUE</code>) because the hexagonal display is not properly rendered in them.</p>
</div>
<div id="more-graphics-on-observations" class="section level4">
<h4 class="hasAnchor">
<a href="#more-graphics-on-observations" class="anchor"></a>More graphics on observations</h4>
<p>Individual information on observations in clustered can be obtained with the following plots:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"obs"</span>, <span class="dt">type =</span> <span class="st">"boxplot"</span>, <span class="dt">show.names =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisObs-1.png" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"obs"</span>, <span class="dt">type =</span> <span class="st">"lines"</span>, <span class="dt">show.names =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisObs-2.png" width="700"></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"obs"</span>, <span class="dt">type =</span> <span class="st">"names"</span>, <span class="dt">show.names =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisObs-3.png" width="700"></p>
<p>They display either the observation distribution within the cluster for all the variables in the dataset (for <code>"boxplot"</code> and <code>"lines"</code>) or the names (row numbers by default) of the observations classified within the cluster.</p>
</div>
<div id="more-graphics-on-prototypes" class="section level4">
<h4 class="hasAnchor">
<a href="#more-graphics-on-prototypes" class="anchor"></a>More graphics on prototypes</h4>
<p>Some more graphics handling prototypes have been implemented:</p>
<ul>
<li>
<code>"3d"</code> provides the same results as <code>"color"</code> but on a 3 dimensional plot: x is the x dimension of the grid, y is the y dimension of the grid and z is the value of the prototype for the variable <code>variable</code> (by name or number in the dataset) of the corresponding neuron. For the hexagonal topology, the plot is obtained using a linear interpolation on a regular square grid.</li>
</ul>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="dt">mfrow=</span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"prototypes"</span>, <span class="dt">type =</span> <span class="st">"3d"</span>, <span class="dt">variable =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb35-3" data-line-number="3"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"prototypes"</span>, <span class="dt">type =</span> <span class="st">"3d"</span>, <span class="dt">variable =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"prototypes"</span>, <span class="dt">type =</span> <span class="st">"3d"</span>, <span class="dt">variable =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb35-5" data-line-number="5"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"prototypes"</span>, <span class="dt">type =</span> <span class="st">"3d"</span>, <span class="dt">variable =</span> <span class="dv">4</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisProto-1.png" width="700"></p>
<p>Also, some graphics are provided to visualize the distance between prototypes on the grid:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"prototypes"</span>, <span class="dt">type =</span> <span class="st">"poly.dist"</span>, <span class="dt">show.names =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisDistProto-1.png" width="700"></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"prototypes"</span>, <span class="dt">type =</span> <span class="st">"umatrix"</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisDistProto2-1.png" width="700"></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"prototypes"</span>, <span class="dt">type =</span> <span class="st">"smooth.dist"</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisDistProto2-2.png" width="700"></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"prototypes"</span>, <span class="dt">type =</span> <span class="st">"mds"</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisDistProto2-3.png" width="700"></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"prototypes"</span>, <span class="dt">type =</span> <span class="st">"grid.dist"</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisDistProto2-4.png" width="700"></p>
<ul>
<li><p><code>"poly.dist"</code> represents the distances between neighboring prototypes with polygons plotted for each cell of the grid. The smaller the distance between a polygon’s vertex and a cell border, the closer the pair of prototypes. The colors indicates the number of observations in the neuron (white is used for empty neurons);</p></li>
<li><p><code>"umatrix"</code> fills the neurons of the grid using colors that represent the average distance between the current prototype and its neighbors;</p></li>
<li><p><code>"smooth.dist"</code> plots the mean distance between the current prototype and its neighbors with a color gradation;</p></li>
<li><p><code>mds</code> plots the number of the neuron on a map according to a Multi Dimensional Scaling (MDS) projection;</p></li>
<li><p><code>grid.dist</code> plots a point for each pair of prototypes, with x coordinates representing the distance between the prototypes in the input space, and y coordinates representing the distance between the corresponding neurons on the grid.</p></li>
</ul>
<p>These graphics show that there is a big gap (large distances) between the top left corner and the rest of the map and between the top right corner and the rest of the map (which is consistent with what was already observed in the previous plots). In addition, the bottom right corner of the maps has a few neurons (21, 22, 23) that are very closed to each others.</p>
</div>
<div id="graphics-showing-an-additional-variable" class="section level4">
<h4 class="hasAnchor">
<a href="#graphics-showing-an-additional-variable" class="anchor"></a>Graphics showing an additional variable</h4>
<div id="additional-factor" class="section level5">
<h5 class="hasAnchor">
<a href="#additional-factor" class="anchor"></a>Additional factor</h5>
<p>The clustering can be analyzed together with an additional variable (here, the flower species) using <code>what = "add"</code>:</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/class.html">class</a></span>(iris<span class="op">$</span>Species)</a></code></pre></div>
<pre><code>## [1] "factor"</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/levels.html">levels</a></span>(iris<span class="op">$</span>Species)</a></code></pre></div>
<pre><code>## [1] "setosa"     "versicolor" "virginica"</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"add"</span>, <span class="dt">type =</span> <span class="st">"pie"</span>, <span class="dt">variable =</span> iris<span class="op">$</span>Species) <span class="op">+</span></a>
<a class="sourceLine" id="cb45-2" data-line-number="2"><span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">type =</span> <span class="st">"qual"</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb45-3" data-line-number="3"><span class="st">  </span><span class="kw">guides</span>(<span class="dt">fill =</span> <span class="kw">guide_legend</span>(<span class="dt">title =</span> <span class="st">"Species"</span>))</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisAdd1-1.png" width="700"></p>
<p>This plot shows that the clustering produced by the SOM is indeed relevant to identify the three different species of iris: they are well separated on the map and almost all clusters only contain one species of iris. The Setosa species is the most distinct from the other two, isolated in the top left corner of the map.</p>
</div>
<div id="additional-numerical-vector" class="section level5">
<h5 class="hasAnchor">
<a href="#additional-numerical-vector" class="anchor"></a>Additional numerical vector</h5>
<p>The <code>"color"</code> plot available for <code>"add"</code> is similar to the <code>"obs"</code> or <code>"prototypes"</code> cases. Here we choose the first variable of the iris data set as an additional variable to illustrate its use. We thus obtain the same plot as above (see section <strong>Graphics common to observations and prototypes</strong>).</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"add"</span>, <span class="dt">type =</span> <span class="st">"color"</span>, <span class="dt">variable =</span> iris<span class="op">$</span>Sepal.Length, </a>
<a class="sourceLine" id="cb46-2" data-line-number="2">     <span class="dt">show.names =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisAdd2-1.png" width="700"></p>
</div>
<div id="additional-numerical-matrix-or-data-frame" class="section level5">
<h5 class="hasAnchor">
<a href="#additional-numerical-matrix-or-data-frame" class="anchor"></a>Additional numerical matrix or data frame</h5>
<p>The <code>"lines"</code>, <code>"barplot"</code>, <code>"radar"</code> and <code>"boxplot"</code> plots available for <code>"add"</code> are similar to the <code>"obs"</code> or <code>"prototypes"</code> cases.</p>
<p><code>"words"</code> is only implemented for an additional variable. In this case, the additional variable must be a contingency matrix: the words used on the plot are the names of the columns and the presence or lack of the word is expressed by respectively 1 or 0. The size of the words on the grid depends on the rate of presence in the observations of the current neuron. To illustrate its use, we define a contingency table <code>my.cont.mat</code> that corresponds to the flower Species:</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(my.cont.mat)</a></code></pre></div>
<pre><code>##      setosa versicolor virginica
## [1,]      1          0         0
## [2,]      1          0         0
## [3,]      1          0         0
## [4,]      1          0         0
## [5,]      1          0         0
## [6,]      1          0         0</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"add"</span>, <span class="dt">type =</span> <span class="st">"words"</span>, <span class="dt">variable =</span> my.cont.mat, </a>
<a class="sourceLine" id="cb49-2" data-line-number="2">     <span class="dt">show.names =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisAdd4-1.png" width="700"></p>
</div>
<div id="additional-non-numerical-vector" class="section level5">
<h5 class="hasAnchor">
<a href="#additional-non-numerical-vector" class="anchor"></a>Additional non-numerical vector</h5>
<p><code>"names"</code> is similar to the <code>"names"</code> case implemented for <code>"obs"</code>. Here we choose to give the argument <code>variable</code> the row names of the iris data set: so we obtain the same plot as above (see <strong>More graphics on observations</strong>).</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"add"</span>, <span class="dt">type =</span> <span class="st">"names"</span>, <span class="dt">variable =</span> <span class="kw"><a href="https://rdrr.io/r/base/colnames.html">rownames</a></span>(iris)) </a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisAdd5-1.png" width="700"></p>
<p>Similarly, this plot can be used with the variable <code>iris$Species</code>:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(iris.som, <span class="dt">what =</span> <span class="st">"add"</span>, <span class="dt">type =</span> <span class="st">"names"</span>, <span class="dt">variable =</span> iris<span class="op">$</span>Species)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisAdd5bis-1.png" width="700"></p>
<p>which gives exactly the same plot as before for type <code>"words"</code> with the contingency matrix corresponding to the variable <code>iris$Species</code>.</p>
</div>
</div>
</div>
<div id="analyze-the-projection-quality" class="section level3">
<h3 class="hasAnchor">
<a href="#analyze-the-projection-quality" class="anchor"></a>Analyze the projection quality</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="kw"><a href="../reference/quality.html">quality</a></span>(iris.som)</a></code></pre></div>
<pre><code>## $topographic
## [1] 0.1466667
## 
## $quantization
## [1] 1.22527</code></pre>
<p>By default, the quality function calculates both quantization and topographic errors. It is also possible to specify which one you want using the argument <code>quality.type</code>.</p>
<p>The topographic error value varies between 0 (good projection quality) and 1 (poor projection quality). Here, the topographic quality of the mapping is equal to 0.15, which means that around 14.7% of the observations have a second best unit in the neighborhood of the best matching unit.</p>
<p>The quantization error is an unbounded positive number. The closer it is to 0, the better the projection quality.</p>
</div>
<div id="building-super-classes-from-the-resulting-som" class="section level3">
<h3 class="hasAnchor">
<a href="#building-super-classes-from-the-resulting-som" class="anchor"></a>Building super classes from the resulting SOM</h3>
<p>In the SOM algorithm, the number of clusters is necessarily close to the number of neurons on the grid (not necessarily equal as some neurons may have no observations assigned to them). This - quite large - number may not suit the original data for a clustering purpose.</p>
<p>A usual way to address clustering with SOM is to perform a hierarchical clustering on the prototypes. This clustering is directly available in the package <code>SOMbrero</code> using the function <code>superClass</code>. To do so, you can first have a quick overview to decide on the number of super clusters which suits your data.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="kw"><a href="../reference/superClass.html">superClass</a></span>(iris.som))</a></code></pre></div>
<pre><code>## Warning in plot.somSC(superClass(iris.som)): Impossible to plot the rectangles: no super clusters.</code></pre>
<p><img src="c-doc-numericSOM_files/figure-html/irisSC-1.png" width="700"></p>
<p>By default, the function plots both a dendrogram and the evolution of the percentage of explained variance. Here, 3 super clusters seem to be the best choice. The output of <code>superClass</code> is a <code>somSC</code> class object. Basic functions have been defined for this class:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" data-line-number="1">my.sc &lt;-<span class="st"> </span><span class="kw"><a href="../reference/superClass.html">superClass</a></span>(iris.som, <span class="dt">k =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb56-2" data-line-number="2"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(my.sc)</a></code></pre></div>
<pre><code>## 
##    SOM Super Classes
##      Initial number of clusters :  25 
##      Number of super clusters   :  3 
## 
## 
##   Frequency table
## 1 2 3 
## 7 9 9 
## 
##   Clustering
##  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 
##  1  2  2  2  2  1  1  2  2  2  3  1  1  2  2  3  3  3  1  1  3  3  3  3  3 
## 
## 
##   ANOVA
## 
##         Degrees of freedom :  2 
## 
##                    F pvalue significativity
## Sepal.Length 178.319      0             ***
## Sepal.Width   60.416      0             ***
## Petal.Length 847.100      0             ***
## Petal.Width  505.974      0             ***</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(my.sc, <span class="dt">plot.var =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisSC3-1.png" width="700"></p>
<p>Like <code>plot.somRes</code>, the function <code>plot.somSC</code> has an argument <code>type</code> which offers many different plots and can thus be combined with most of the graphics produced by <code>plot.somSC</code>:</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(my.sc, <span class="dt">type =</span> <span class="st">"grid"</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisSCplot-1.png" width="576"></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(my.sc, <span class="dt">type =</span> <span class="st">"dendro3d"</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisSCplot3d-1.png" width="700"></p>
<p>Case <code>"grid"</code> fills the grid with colors according to the super clustering (and can provide a legend). Case <code>"dendro3d"</code> plots a 3d dendrogram.</p>
<p>A couple of plots from <code>plot.somRes</code> are also available for the super clustering. Some identify the super clusters with colors:</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(my.sc, <span class="dt">what =</span> <span class="st">"obs"</span>, <span class="dt">type =</span> <span class="st">"hitmap"</span>, <span class="dt">maxsize =</span> <span class="dv">20</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisSCplot2-1.png" width="576"></p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(my.sc, <span class="dt">what =</span> <span class="st">"prototypes"</span>, <span class="dt">type =</span> <span class="st">"lines"</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisSCplot2B-1.png" width="700"></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(my.sc, <span class="dt">what =</span> <span class="st">"prototypes"</span>, <span class="dt">type =</span> <span class="st">"barplot"</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisSCplot2B-2.png" width="700"></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(my.sc, <span class="dt">what =</span> <span class="st">"prototypes"</span>, <span class="dt">type =</span> <span class="st">"mds"</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisSCplot2C-1.png" width="576"></p>
<p>And some others identify the super clusters with titles:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(my.sc, <span class="dt">what =</span> <span class="st">"prototypes"</span>, <span class="dt">type =</span> <span class="st">"color"</span>, <span class="dt">variable =</span> <span class="st">"Sepal.Length"</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisSCplot3-1.png" width="700"></p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(my.sc, <span class="dt">what =</span> <span class="st">"prototypes"</span>, <span class="dt">type =</span> <span class="st">"poly.dist"</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisSCplot3-2.png" width="700"></p>
<p>It is also possible to consider an additional variable using the argument <code>what='add'</code>:</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(my.sc, <span class="dt">what =</span> <span class="st">"add"</span>, <span class="dt">type =</span> <span class="st">"pie"</span>, <span class="dt">variable =</span> iris<span class="op">$</span>Species) <span class="op">+</span></a>
<a class="sourceLine" id="cb67-2" data-line-number="2"><span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">type =</span> <span class="st">"qual"</span>)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisSCplot4-1.png" width="700"></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(my.sc, <span class="dt">what =</span> <span class="st">"add"</span>, <span class="dt">type =</span> <span class="st">"color"</span>, <span class="dt">variable =</span> iris<span class="op">$</span>Sepal.Length)</a></code></pre></div>
<p><img src="c-doc-numericSOM_files/figure-html/irisSCplot4-2.png" width="700"></p>
<p>Super cluster number 2 is located at the top left hand corner of the map and associated with the Setosa species. SC 3 is in the opposite corner and associated mainly with Virginica whereas SC 1 is in the diagonal between these two corners and associated with Versicolor.</p>
</div>
<div id="session-information" class="section level3">
<h3 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session information</h3>
<p>This vignette has been computed with the following environment:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()</a></code></pre></div>
<pre><code>## R version 3.6.3 (2020-02-29)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 18.04.4 LTS
## 
## Matrix products: default
## BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.7.1
## LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.7.1
## 
## locale:
##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=fr_FR.UTF-8        LC_COLLATE=en_US.UTF-8    
##  [5] LC_MONETARY=fr_FR.UTF-8    LC_MESSAGES=en_US.UTF-8   
##  [7] LC_PAPER=fr_FR.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=fr_FR.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] SOMbrero_1.3   igraph_1.2.4.1 ggplot2_3.3.0 
## 
## loaded via a namespace (and not attached):
##  [1] tidyselect_1.0.0     xfun_0.13            purrr_0.3.3         
##  [4] lattice_0.20-41      colorspace_1.4-1     htmltools_0.3.6     
##  [7] yaml_2.2.0           rlang_0.4.5          pkgdown_1.4.1       
## [10] hexbin_1.27.3        pillar_1.4.3         glue_1.4.0          
## [13] withr_2.1.2          sp_1.3-1             RColorBrewer_1.1-2  
## [16] lifecycle_0.2.0      plyr_1.8.4           stringr_1.4.0       
## [19] metR_0.7.0           munsell_0.5.0        gtable_0.3.0        
## [22] codetools_0.2-16     memoise_1.1.0        evaluate_0.14       
## [25] labeling_0.3         ggwordcloud_0.5.0    knitr_1.23          
## [28] Rcpp_1.0.4.6         scales_1.1.0         backports_1.1.4     
## [31] checkmate_1.9.4      desc_1.2.0           scatterplot3d_0.3-41
## [34] deldir_0.1-25        farver_2.0.3         fs_1.3.1            
## [37] interp_1.0-33        png_0.1-7            digest_0.6.20       
## [40] stringi_1.4.3        dplyr_0.8.3          grid_3.6.3          
## [43] rprojroot_1.3-2      tools_3.6.3          magrittr_1.5        
## [46] tibble_2.1.3         crayon_1.3.4         pkgconfig_2.0.2     
## [49] MASS_7.3-51.6        data.table_1.12.2    lubridate_1.7.4     
## [52] assertthat_0.2.1     rmarkdown_1.14       rstudioapi_0.10     
## [55] R6_2.4.1             compiler_3.6.3</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#basic-package-description">Basic package description</a></li>
      <li><a href="#first-case-study-simulated-data-in-012">First case study: simulated data in <span class="math inline">\([0,1]^2\)</span></a></li>
      <li><a href="#second-case-study-the-iris-dataset">Second case study: the iris dataset</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Nathalie Vialaneix, Elise Maigne, Jerome Mariette, Madalina Olteanu, Fabrice Rossi.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
